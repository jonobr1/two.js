(function(){var p=this,m=p._,d={},g=Array.prototype,l=Object.prototype,b=g.push,c=g.slice,v=g.concat,a=l.toString,k=l.hasOwnProperty,n=g.forEach,q=g.map,w=g.reduce,f=g.reduceRight,r=g.filter,A=g.every,z=g.some,u=g.indexOf,x=g.lastIndexOf,l=Array.isArray,s=Object.keys,t=Function.prototype.bind,e=function(h){if(h instanceof e)return h;if(!(this instanceof e))return new e(h);this._wrapped=h};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=
e):p._=e;e.VERSION="1.5.1";var y=e.each=e.forEach=function(h,a,b){if(null!=h)if(n&&h.forEach===n)h.forEach(a,b);else if(h.length===+h.length)for(var c=0,k=h.length;c<k&&a.call(b,h[c],c,h)!==d;c++);else for(c in h)if(e.has(h,c)&&a.call(b,h[c],c,h)===d)break};e.map=e.collect=function(h,e,a){var b=[];if(null==h)return b;if(q&&h.map===q)return h.map(e,a);y(h,function(h,c,k){b.push(e.call(a,h,c,k))});return b};e.reduce=e.foldl=e.inject=function(h,a,b,c){var k=2<arguments.length;null==h&&(h=[]);if(w&&h.reduce===
w)return c&&(a=e.bind(a,c)),k?h.reduce(a,b):h.reduce(a);y(h,function(h,e,f){k?b=a.call(c,b,h,e,f):(b=h,k=!0)});if(!k)throw new TypeError("Reduce of empty array with no initial value");return b};e.reduceRight=e.foldr=function(h,a,b,c){var k=2<arguments.length;null==h&&(h=[]);if(f&&h.reduceRight===f)return c&&(a=e.bind(a,c)),k?h.reduceRight(a,b):h.reduceRight(a);var s=h.length;if(s!==+s)var t=e.keys(h),s=t.length;y(h,function(e,f,l){f=t?t[--s]:--s;k?b=a.call(c,b,h[f],f,l):(b=h[f],k=!0)});if(!k)throw new TypeError("Reduce of empty array with no initial value");
return b};e.find=e.detect=function(h,e,a){var b;B(h,function(h,c,k){if(e.call(a,h,c,k))return b=h,!0});return b};e.filter=e.select=function(h,e,a){var b=[];if(null==h)return b;if(r&&h.filter===r)return h.filter(e,a);y(h,function(h,c,k){e.call(a,h,c,k)&&b.push(h)});return b};e.reject=function(h,a,b){return e.filter(h,function(h,e,c){return!a.call(b,h,e,c)},b)};e.every=e.all=function(h,a,b){a||(a=e.identity);var c=!0;if(null==h)return c;if(A&&h.every===A)return h.every(a,b);y(h,function(h,e,k){if(!(c=
c&&a.call(b,h,e,k)))return d});return!!c};var B=e.some=e.any=function(h,a,b){a||(a=e.identity);var c=!1;if(null==h)return c;if(z&&h.some===z)return h.some(a,b);y(h,function(h,e,k){if(c||(c=a.call(b,h,e,k)))return d});return!!c};e.contains=e.include=function(h,e){return null==h?!1:u&&h.indexOf===u?-1!=h.indexOf(e):B(h,function(h){return h===e})};e.invoke=function(h,a){var b=c.call(arguments,2),k=e.isFunction(a);return e.map(h,function(h){return(k?a:h[a]).apply(h,b)})};e.pluck=function(h,a){return e.map(h,
function(h){return h[a]})};e.where=function(h,a,b){return e.isEmpty(a)?b?void 0:[]:e[b?"find":"filter"](h,function(h){for(var e in a)if(a[e]!==h[e])return!1;return!0})};e.findWhere=function(h,a){return e.where(h,a,!0)};e.max=function(h,a,b){if(!a&&e.isArray(h)&&h[0]===+h[0]&&65535>h.length)return Math.max.apply(Math,h);if(!a&&e.isEmpty(h))return-Infinity;var c={computed:-Infinity,value:-Infinity};y(h,function(h,e,k){e=a?a.call(b,h,e,k):h;e>c.computed&&(c={value:h,computed:e})});return c.value};e.min=
function(h,a,b){if(!a&&e.isArray(h)&&h[0]===+h[0]&&65535>h.length)return Math.min.apply(Math,h);if(!a&&e.isEmpty(h))return Infinity;var c={computed:Infinity,value:Infinity};y(h,function(h,e,k){e=a?a.call(b,h,e,k):h;e<c.computed&&(c={value:h,computed:e})});return c.value};e.shuffle=function(h){var a,b=0,c=[];y(h,function(h){a=e.random(b++);c[b-1]=c[a];c[a]=h});return c};var D=function(h){return e.isFunction(h)?h:function(e){return e[h]}};e.sortBy=function(h,a,b){var c=D(a);return e.pluck(e.map(h,function(h,
e,a){return{value:h,index:e,criteria:c.call(b,h,e,a)}}).sort(function(h,e){var a=h.criteria,b=e.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return h.index<e.index?-1:1}),"value")};var R=function(h,a,b,c){var k={},f=D(null==a?e.identity:a);y(h,function(e,a){var s=f.call(b,e,a,h);c(k,s,e)});return k};e.groupBy=function(h,a,b){return R(h,a,b,function(h,a,b){(e.has(h,a)?h[a]:h[a]=[]).push(b)})};e.countBy=function(h,a,b){return R(h,a,b,function(h,a){e.has(h,a)||(h[a]=0);
h[a]++})};e.sortedIndex=function(h,a,b,c){b=null==b?e.identity:D(b);a=b.call(c,a);for(var k=0,f=h.length;k<f;){var s=k+f>>>1;b.call(c,h[s])<a?k=s+1:f=s}return k};e.toArray=function(h){return h?e.isArray(h)?c.call(h):h.length===+h.length?e.map(h,e.identity):e.values(h):[]};e.size=function(h){return null==h?0:h.length===+h.length?h.length:e.keys(h).length};e.first=e.head=e.take=function(h,e,a){return null==h?void 0:null==e||a?h[0]:c.call(h,0,e)};e.initial=function(h,e,a){return c.call(h,0,h.length-
(null==e||a?1:e))};e.last=function(h,e,a){return null==h?void 0:null==e||a?h[h.length-1]:c.call(h,Math.max(h.length-e,0))};e.rest=e.tail=e.drop=function(h,e,a){return c.call(h,null==e||a?1:e)};e.compact=function(h){return e.filter(h,e.identity)};var S=function(h,a,c){if(a&&e.every(h,e.isArray))return v.apply(c,h);y(h,function(h){e.isArray(h)||e.isArguments(h)?a?b.apply(c,h):S(h,a,c):c.push(h)});return c};e.flatten=function(h,e){return S(h,e,[])};e.without=function(h){return e.difference(h,c.call(arguments,
1))};e.uniq=e.unique=function(h,a,b,c){e.isFunction(a)&&(c=b,b=a,a=!1);b=b?e.map(h,b,c):h;var k=[],f=[];y(b,function(b,c){(a?c&&f[f.length-1]===b:e.contains(f,b))||(f.push(b),k.push(h[c]))});return k};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=function(h){var a=c.call(arguments,1);return e.filter(e.uniq(h),function(h){return e.every(a,function(a){return 0<=e.indexOf(a,h)})})};e.difference=function(h){var a=v.apply(g,c.call(arguments,1));return e.filter(h,function(h){return!e.contains(a,
h)})};e.zip=function(){for(var h=e.max(e.pluck(arguments,"length").concat(0)),a=Array(h),b=0;b<h;b++)a[b]=e.pluck(arguments,""+b);return a};e.object=function(h,a){if(null==h)return{};for(var e={},b=0,c=h.length;b<c;b++)a?e[h[b]]=a[b]:e[h[b][0]]=h[b][1];return e};e.indexOf=function(h,a,b){if(null==h)return-1;var c=0,k=h.length;if(b)if("number"==typeof b)c=0>b?Math.max(0,k+b):b;else return c=e.sortedIndex(h,a),h[c]===a?c:-1;if(u&&h.indexOf===u)return h.indexOf(a,b);for(;c<k;c++)if(h[c]===a)return c;
return-1};e.lastIndexOf=function(h,a,e){if(null==h)return-1;var b=null!=e;if(x&&h.lastIndexOf===x)return b?h.lastIndexOf(a,e):h.lastIndexOf(a);for(e=b?e:h.length;e--;)if(h[e]===a)return e;return-1};e.range=function(a,e,b){1>=arguments.length&&(e=a||0,a=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((e-a)/b),0),k=0,f=Array(c);k<c;)f[k++]=a,a+=b;return f};var K=function(){};e.bind=function(a,b){var k,f;if(t&&a.bind===t)return t.apply(a,c.call(arguments,1));if(!e.isFunction(a))throw new TypeError;
k=c.call(arguments,2);return f=function(){if(!(this instanceof f))return a.apply(b,k.concat(c.call(arguments)));K.prototype=a.prototype;var e=new K;K.prototype=null;var s=a.apply(e,k.concat(c.call(arguments)));return Object(s)===s?s:e}};e.partial=function(a){var e=c.call(arguments,1);return function(){return a.apply(this,e.concat(c.call(arguments)))}};e.bindAll=function(a){var b=c.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");y(b,function(b){a[b]=e.bind(a[b],
a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var k=b.apply(this,arguments);return e.has(c,k)?c[k]:c[k]=a.apply(this,arguments)}};e.delay=function(a,e){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},e)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(c.call(arguments,1)))};e.throttle=function(a,e,b){var c,k,f,s=null,t=0;b||(b={});var l=function(){t=!1===b.leading?0:new Date;s=null;f=a.apply(c,k)};return function(){var g=
new Date;t||!1!==b.leading||(t=g);var d=e-(g-t);c=this;k=arguments;0>=d?(clearTimeout(s),s=null,t=g,f=a.apply(c,k)):s||!1===b.trailing||(s=setTimeout(l,d));return f}};e.debounce=function(a,e,b){var c,k=null;return function(){var f=this,s=arguments,t=b&&!k;clearTimeout(k);k=setTimeout(function(){k=null;b||(c=a.apply(f,s))},e);t&&(c=a.apply(f,s));return c}};e.once=function(a){var e=!1,b;return function(){if(e)return b;e=!0;b=a.apply(this,arguments);a=null;return b}};e.wrap=function(a,e){return function(){var c=
[a];b.apply(c,arguments);return e.apply(this,c)}};e.compose=function(){var a=arguments;return function(){for(var e=arguments,b=a.length-1;0<=b;b--)e=[a[b].apply(this,e)];return e[0]}};e.after=function(a,e){return function(){if(1>--a)return e.apply(this,arguments)}};e.keys=s||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&b.push(c);return b};e.values=function(a){var b=[],c;for(c in a)e.has(a,c)&&b.push(a[c]);return b};e.pairs=function(a){var b=
[],c;for(c in a)e.has(a,c)&&b.push([c,a[c]]);return b};e.invert=function(a){var b={},c;for(c in a)e.has(a,c)&&(b[a[c]]=c);return b};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){y(c.call(arguments,1),function(e){if(e)for(var b in e)a[b]=e[b]});return a};e.pick=function(a){var e={},b=v.apply(g,c.call(arguments,1));y(b,function(b){b in a&&(e[b]=a[b])});return e};e.omit=function(a){var b={},k=v.apply(g,c.call(arguments,1)),
f;for(f in a)e.contains(k,f)||(b[f]=a[f]);return b};e.defaults=function(a){y(c.call(arguments,1),function(e){if(e)for(var b in e)void 0===a[b]&&(a[b]=e[b])});return a};e.clone=function(a){return e.isObject(a)?e.isArray(a)?a.slice():e.extend({},a):a};e.tap=function(a,e){e(a);return a};var L=function(b,c,k,f){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof e&&(b=b._wrapped);c instanceof e&&(c=c._wrapped);var s=a.call(b);if(s!=a.call(c))return!1;switch(s){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var t=k.length;t--;)if(k[t]==b)return f[t]==c;var t=b.constructor,l=c.constructor;if(t!==l&&!(e.isFunction(t)&&t instanceof t&&e.isFunction(l)&&l instanceof l))return!1;k.push(b);f.push(c);t=0;
l=!0;if("[object Array]"==s){if(t=b.length,l=t==c.length)for(;t--&&(l=L(b[t],c[t],k,f)););}else{for(var g in b)if(e.has(b,g)&&(t++,!(l=e.has(c,g)&&L(b[g],c[g],k,f))))break;if(l){for(g in c)if(e.has(c,g)&&!t--)break;l=!t}}k.pop();f.pop();return l};e.isEqual=function(a,b){return L(a,b,[],[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!(!a||1!==a.nodeType)};e.isArray=l||function(b){return"[object Array]"==
a.call(b)};e.isObject=function(a){return a===Object(a)};y("Arguments Function String Number Date RegExp".split(" "),function(b){e["is"+b]=function(e){return a.call(e)=="[object "+b+"]"}});e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});"function"!==typeof/./&&(e.isFunction=function(a){return"function"===typeof a});e.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};e.isNaN=function(a){return e.isNumber(a)&&a!=+a};e.isBoolean=function(b){return!0===
b||!1===b||"[object Boolean]"==a.call(b)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return k.call(a,b)};e.noConflict=function(){p._=m;return this};e.identity=function(a){return a};e.times=function(a,b,e){for(var c=Array(Math.max(0,a)),k=0;k<a;k++)c[k]=b.call(e,k);return c};e.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=e.invert(J.escape);var T={escape:RegExp("["+e.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+e.keys(J.unescape).join("|")+")","g")};e.each(["escape","unescape"],function(a){e[a]=function(b){return null==b?"":(""+b).replace(T[a],function(b){return J[a][b]})}});e.result=function(a,b){if(null!=a){var c=a[b];return e.isFunction(c)?c.call(a):c}};e.mixin=function(a){y(e.functions(a),function(c){var k=e[c]=a[c];e.prototype[c]=function(){var a=[this._wrapped];b.apply(a,arguments);a=k.apply(e,
a);return this._chain?e(a).chain():a}})};var U=0;e.uniqueId=function(a){var b=++U+"";return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\t|\u2028|\u2029/g;e.template=function(a,b,c){var k;c=e.defaults({},c,e.templateSettings);var f=RegExp([(c.escape||M).source,(c.interpolate||M).source,(c.evaluate||M).source].join("|")+
"|$","g"),s=0,t="__p+='";a.replace(f,function(b,e,c,k,f){t+=a.slice(s,f).replace(G,function(a){return"\\"+V[a]});e&&(t+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'");c&&(t+="'+\n((__t=("+c+"))==null?'':__t)+\n'");k&&(t+="';\n"+k+"\n__p+='");s=f+b.length;return b});t+="';\n";c.variable||(t="with(obj||{}){\n"+t+"}\n");t="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+t+"return __p;\n";try{k=new Function(c.variable||"obj","_",t)}catch(l){throw l.source=
t,l;}if(b)return k(b,e);b=function(a){return k.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+t+"}";return b};e.chain=function(a){return e(a).chain()};e.mixin(e);y("pop push reverse shift sort splice unshift".split(" "),function(a){var b=g[a];e.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);"shift"!=a&&"splice"!=a||0!==c.length||delete c[0];return this._chain?e(c).chain():c}});y(["concat","join","slice"],function(a){var b=g[a];e.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?e(a).chain():a}});e.extend(e.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var p=[].slice,m=function(g,l,b){var c;g=-1;var d=l.length;switch(b.length){case 0:for(;++g<d;)(c=l[g]).callback.call(c.ctx);break;case 1:for(;++g<d;)(c=l[g]).callback.call(c.ctx,b[0]);break;case 2:for(;++g<d;)(c=l[g]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++g<d;)(c=l[g]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++g<d;)(c=l[g]).callback.apply(c.ctx,b)}},d=Backbone.Events={on:function(g,l,b){this._events||(this._events={});(this._events[g]||(this._events[g]=[])).push({callback:l,
context:b,ctx:b||this});return this},once:function(g,l,b){var c=this,d=_.once(function(){c.off(g,d);l.apply(this,arguments)});d._callback=l;this.on(g,d,b);return this},off:function(g,l,b){var c,d,a,k,n,q,w,f;if(!this._events)return this;if(!g&&!l&&!b)return this._events={},this;k=g?[g]:_.keys(this._events);n=0;for(q=k.length;n<q;n++)if(g=k[n],c=this._events[g]){a=[];if(l||b)for(w=0,f=c.length;w<f;w++)d=c[w],(l&&l!==(d.callback._callback||d.callback)||b&&b!==d.context)&&a.push(d);this._events[g]=a}return this},
trigger:function(d){if(!this._events)return this;var l=p.call(arguments,1),b=this._events[d],c=this._events.all;b&&m(this,b,l);c&&m(this,c,arguments);return this},listenTo:function(d,l,b){var c=this._listeners||(this._listeners={}),v=d._listenerId||(d._listenerId=_.uniqueId("l"));c[v]=d;d.on(l,b||this,this);return this},stopListening:function(d,l,b){var c=this._listeners;if(c){if(d)d.off(l,b,this),l||b||delete c[d._listenerId];else{for(var v in c)c[v].off(null,null,this);this._listeners={}}return this}}};
d.bind=d.on;d.unbind=d.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports.Backbone=exports.Backbone||Backbone)})();(function(){function p(b,c){var l=(new Date).getTime(),a=Math.max(0,16-(l-d)),k=m.setTimeout(function(){b(l+a)},a);d=l+a;return k}var m=this,d=0,g=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=p),exports.requestAnimationFrame=p;else{for(var l=0;l<g.length&&!m.requestAnimationFrame;++l)m.requestAnimationFrame=m[g[l]+"RequestAnimationFrame"],m.cancelAnimationFrame=m[g[l]+"CancelAnimationFrame"]||m[g[l]+"CancelRequestAnimationFrame"];
m.requestAnimationFrame||(m.requestAnimationFrame=p);m.cancelAnimationFrame||(m.cancelAnimationFrame=function(b){clearTimeout(b)})}})();(function(){function p(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(f.Events.resize,b,a)}var m=this,d=m.Two||{},g=Math.sin,l=Math.cos,b=Math.atan2,c=Math.sqrt,v=Math.abs,a=Math.PI,k=2*a,n=a/2,q=Math.pow,w={hasEventListeners:_.isFunction(m.addEventListener),bind:function(a,b,e,c){this.hasEventListeners?a.addEventListener(b,e,!!c):a.attachEvent("on"+b,e);return this},unbind:function(a,b,e,c){this.hasEventListeners?
a.removeEventListeners(b,e,!!c):a.detachEvent("on"+b,e);return this}},f=m.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:f.Types.svg,autostart:!1});this.type=a.type;this.renderer=new f[this.type](this);f.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(p,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),w.bind(m,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new f.Group;this.renderer.add(this.scene);f.Instances.push(this)};_.extend(f,{Array:m.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.3.0",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",
remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){m.Two=d;return this},Utils:{Curve:{CollinearityEpsilon:q(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},getComputedMatrix:function(a){for(var b=new f.Matrix;a&&a._matrix;){var e=a._matrix.elements;b.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]);
a=a.parent}return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a,c){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=
a.nodeValue}});return b},read:{svg:function(){return f.Utils.read.g.apply(this,arguments)},g:function(a){var b=new f.Group;this.add(b);_.each(a.childNodes,function(a){var c=a.nodeName;c&&(c=c.replace(/svg\:/ig,"").toLowerCase(),c in f.Utils.read&&(a=f.Utils.read[c].call(this,a),b.add(a)))},this);return f.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var e=a.points;if(e){var c=_.map(_.range(e.numberOfItems),function(a){a=e.getItem(a);return new f.Anchor(a.x,a.y)}),c=(new f.Polygon(c,!b)).noStroke();
return f.Utils.applySvgAttributes(a,c)}},polyline:function(a){return f.Utils.read.polygon(a,!0)},path:function(a){var b,e,c,k=!1,l=!1,d=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),g=d.length-1,d=_.flatten(_.map(d,function(a,d){var s,n,q=a[0],v=q.toLowerCase();c=a.slice(1).trim();c=c.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,e){return parseFloat(b)*Math.pow(10,e)});c=c.split(/[\s,]+|(?=\s?[+\-])/);k=q===v;var w,m,h,r;switch(v){case "z":d>=g?l=!0:(n=b.x,s=b.y,s=new f.Anchor(n,s,
void 0,void 0,void 0,void 0,f.Commands.close));break;case "m":case "l":n=parseFloat(c[0]);s=parseFloat(c[1]);s=new f.Anchor(n,s,void 0,void 0,void 0,void 0,"m"===v?f.Commands.move:f.Commands.line);k&&s.addSelf(b);b=s;break;case "h":case "v":n="h"===v?"x":"y";q="x"===n?"y":"x";s=new f.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,f.Commands.line);s[n]=parseFloat(c[0]);s[q]=b[q];k&&(s[n]+=b[n]);b=s;break;case "s":case "c":s=b.x;q=b.y;e||(e=(new f.Vector).copy(b));"c"===v?(w=parseFloat(c[0]),n=parseFloat(c[1]),
v=parseFloat(c[2]),m=parseFloat(c[3]),h=parseFloat(c[4]),r=parseFloat(c[5])):(m=f.Utils.getReflection(b,e,k),w=m.x,n=m.y,v=parseFloat(c[0]),m=parseFloat(c[1]),h=parseFloat(c[2]),r=parseFloat(c[3]));k&&(w+=s,n+=q,v+=s,m+=q,h+=s,r+=q);_.isObject(b.controls)||f.Anchor.AppendCurveProperties(b);b.controls.right.set(w,n);b=s=new f.Anchor(h,r,v,m,void 0,void 0,f.Commands.curve);e=s.controls.left;break;case "t":case "q":s=b.x;q=b.y;e||(e=(new f.Vector).copy(b));e.isZero()?(w=s,n=q):(w=e.x,q=e.y);"q"===v?
(v=parseFloat(c[0]),m=parseFloat(c[1]),h=parseFloat(c[1]),r=parseFloat(c[2])):(m=f.Utils.getReflection(b,e,k),v=m.x,m=m.y,h=parseFloat(c[0]),r=parseFloat(c[1]));k&&(w+=s,n+=q,v+=s,m+=q,h+=s,r+=q);_.isObject(b.controls)||f.Anchor.AppendCurveProperties(b);b.controls.right.set(w,n);b=s=new f.Anchor(h,r,v,m,void 0,void 0,f.Commands.curve);e=s.controls.left;break;case "a":throw new f.Utils.Error("not yet able to interpret Elliptical Arcs.");}return s}));if(!(1>=d.length))return d=_.compact(d),d=(new f.Polygon(d,
l,void 0,!0)).noStroke(),f.Utils.applySvgAttributes(a,d)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("r")),d=f.Resolution,n=_.map(_.range(d),function(a){var b=a/d*k;a=c*l(b);b=c*g(b);return new f.Anchor(a,b)},this),n=(new f.Polygon(n,!0,!0)).noStroke();n.translation.set(b,e);return f.Utils.applySvgAttributes(a,n)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("rx")),
d=parseFloat(a.getAttribute("ry")),n=f.Resolution,q=_.map(_.range(n),function(a){var b=a/n*k;a=c*l(b);b=d*g(b);return new f.Anchor(a,b)},this),q=(new f.Polygon(q,!0,!0)).noStroke();q.translation.set(b,e);return f.Utils.applySvgAttributes(a,q)},rect:function(a){var b=parseFloat(a.getAttribute("x")),e=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),k=parseFloat(a.getAttribute("height")),c=c/2,k=k/2,d=[new f.Anchor(c,k),new f.Anchor(-c,k),new f.Anchor(-c,-k),new f.Anchor(c,-k)],
d=(new f.Polygon(d,!0)).noStroke();d.translation.set(b+c,e+k);return f.Utils.applySvgAttributes(a,d)},line:function(a){var b=parseFloat(a.getAttribute("x1")),e=parseFloat(a.getAttribute("y1")),c=parseFloat(a.getAttribute("x2")),k=parseFloat(a.getAttribute("y2")),c=(c-b)/2,k=(k-e)/2,d=[new f.Anchor(-c,-k),new f.Anchor(c,k)],d=(new f.Polygon(d)).noFill();d.translation.set(b+c,e+k);return f.Utils.applySvgAttributes(a,d)}},subdivide:function(c,d,e,l,n,g,q,w,m){var r=f.Utils.Curve.CollinearityEpsilon,
A=f.Utils.Curve.RecursionLimit,z=f.Utils.Curve.CuspLimit,u=f.Utils.Curve.Tolerance,p;m=m||0;if(m>A)return[];var A=(c+e)/2,x=(d+l)/2,G=(e+n)/2,h=(l+g)/2,N=(n+q)/2,O=(g+w)/2,P=(A+G)/2,Q=(x+h)/2,G=(G+N)/2,h=(h+O)/2,E=(P+G)/2,F=(Q+h)/2;p=q-c;var C=w-d,H=v((e-q)*C-(l-w)*p),I=v((n-q)*C-(g-w)*p);if(0<m){if(H>r&&I>r&&(H+I)*(H+I)<=u.distance*(p*p+C*C)){if(u.angle<u.epsilon)return[new f.Anchor(E,F)];p=b(g-l,n-e);r=v(p-b(l-d,e-c));p=v(b(w-g,q-n)-p);r>=a&&(r=k-r);p>=a&&(p=k-p);if(r+p<u.angle)return[new f.Anchor(E,
F)];if(0!==z){if(r>z)return[new f.Anchor(e,l)];if(p>z)return[new f.Anchor(n,g)]}}}else if(H>r)if(H*H<=u.distance*(p*p+C*C)){if(u.angle<u.epsilon)return[new f.Anchor(E,F)];r=v(b(g-l,n-e)-b(l-d,e-c));r>=a&&(r=k-r);if(r<u.angle)return[new f.Anchor(e,l),new f.Anchor(n,g)];if(0!==z&&r>z)return[new f.Anchor(e,l)]}else if(I>r){if(I*I<=u.distance*(p*p+C*C)){if(u.angle<u.epsilon)return[new f.Anchor(E,F)];r=v(b(w-g,q-n)-b(g-l,n-e));r>=a&&(r=k-r);if(r<u.angle)return[new f.Anchor(e,l),new f.Anchor(n,g)];if(0!==
z&&r>z)return[new f.Anchor(n,g)]}}else if(p=E-(c+q)/2,C=F-(d+w)/2,p*p+C*C<=u.distance)return[new f.Anchor(E,F)];return f.Utils.subdivide(c,d,A,x,P,Q,E,F,m+1).concat(f.Utils.subdivide(E,F,G,h,N,O,q,w,m+1))},getCurveFromPoints:function(a,b){for(var c=a.length,k=c-1,d=0;d<c;d++){var l=a[d];_.isObject(l.controls)||f.Anchor.AppendCurveProperties(l);var n=b?x(d-1,c):Math.max(d-1,0),g=b?x(d+1,c):Math.min(d+1,k);u(a[n],l,a[g]);l._command=0===d?f.Commands.move:f.Commands.curve;l.controls.left.x=_.isNumber(l.controls.left.x)?
l.controls.left.x:l.x;l.controls.left.y=_.isNumber(l.controls.left.y)?l.controls.left.y:l.y;l.controls.right.x=_.isNumber(l.controls.right.x)?l.controls.right.x:l.x;l.controls.right.y=_.isNumber(l.controls.right.y)?l.controls.right.y:l.y}},getControlPoints:function(b,c,e){var k=z(b,c),d=z(e,c);b=r(b,c);e=r(e,c);var q=(k+d)/2;c.u=_.isObject(c.controls.left)?c.controls.left:new f.Vector(c.x,c.y);c.v=_.isObject(c.controls.right)?c.controls.right:new f.Vector(c.x,c.y);if(1E-4>b||1E-4>e)return c.controls.left.copy(c),
c.controls.right.copy(c),c;b*=0.33;e*=0.33;q=d<k?q+n:q-n;c.controls.left.x=c.x+l(q)*b;c.controls.left.y=c.y+g(q)*b;q-=a;c.controls.right.x=c.x+l(q)*e;c.controls.right.y=c.y+g(q)*e;return c},getReflection:function(a,b,c){var k=a.distanceTo(b);if(1E-4>=k)return c?new f.Vector:a.clone();b=z(a,b);return new f.Vector(k*Math.cos(b)+(c?0:a.x),k*Math.sin(b)+(c?0:a.y))},angleBetween:function(a,c){return b(a.y-c.y,a.x-c.x)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,k=a.y-b.y;return c*c+k*k},distanceBetween:function(a,
b){return c(A(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});f.Utils.Error.prototype=Error();f.Utils.Error.prototype.constructor=f.Utils.Error;f.Utils.Collection.prototype=[];f.Utils.Collection.constructor=f.Utils.Collection;_.extend(f.Utils.Collection.prototype,
Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(f.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(f.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(f.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,arguments);this.trigger(f.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,
arguments),b;this.trigger(f.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(f.Events.insert,b));return a}});var r=f.Utils.distanceBetween,A=f.Utils.distanceBetweenSquared,z=f.Utils.angleBetween,u=f.Utils.getControlPoints,x=f.Utils.mod;_.extend(f.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){f.Utils.setPlaying.call(this,!0);return this.trigger(f.Events.play)},pause:function(){this.playing=
!1;return this.trigger(f.Events.pause)},update:function(){_.defer(_.bind(function(){var a=!!this._lastFrame,b=(m.performance&&m.performance.now?m.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,c=this.renderer;a===c.width&&b===c.height||c.setSize(a,b);this.trigger(f.Events.update,this.frameCount,this.timeDelta);this.render()},this));return this},render:function(){this.renderer.render();return this.trigger(f.Events.render,
this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,c,k){c=(c-a)/2;k=(k-b)/2;var d=[new f.Anchor(-c,-k),new f.Anchor(c,k)],d=(new f.Polygon(d)).noFill();d.translation.set(a+c,b+k);this.scene.add(d);return d},makeRectangle:function(a,b,c,
k){c/=2;k/=2;k=[new f.Anchor(c,k),new f.Anchor(-c,k),new f.Anchor(-c,-k),new f.Anchor(c,-k)];k=new f.Polygon(k,!0);k.translation.set(a,b);this.scene.add(k);return k},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,d){var n=f.Resolution,q=_.map(_.range(n),function(a){var b=a/n*k;a=c*l(b);b=d*g(b);return new f.Anchor(a,b)},this),q=new f.Polygon(q,!0,!0);q.translation.set(a,b);this.scene.add(q);return q},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=
[],k=0;k<b;k+=2){var d=arguments[k];if(!_.isNumber(d))break;c.push(new f.Anchor(d,arguments[k+1]))}var b=arguments[b-1],c=new f.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),l=b.left+b.width/2,n=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=l;a.y-=n});c.translation.set(l,n);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],k=0;k<b;k+=2){var d=arguments[k];if(!_.isNumber(d))break;c.push(new f.Anchor(d,arguments[k+1]))}b=
arguments[b-1];c=new f.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new f.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in f.Utils.read))return null;a=f.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(f.Instances,function(a){a.playing&&a.update()});
requestAnimationFrame(arguments.callee)})();"function"===typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof module&&module.exports&&(module.exports=f)})();(function(){var p=Two.Vector=function(d,g){this.x=d||0;this.y=g||0};_.extend(p,{MakeGetterSetter:function(d,g,l){var b="_"+g;Object.defineProperty(d,g,{get:function(){return this[b]},set:function(c){this[b]=c;this.trigger(Two.Events.change,g)}});d[b]=l}});_.extend(p.prototype,Backbone.Events,{set:function(d,g){this.x=d;this.y=g;return this},copy:function(d){this.x=d.x;this.y=d.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new p(this.x,this.y)},add:function(d,
g){this.x=d.x+g.x;this.y=d.y+g.y;return this},addSelf:function(d){this.x+=d.x;this.y+=d.y;return this},sub:function(d,g){this.x=d.x-g.x;this.y=d.y-g.y;return this},subSelf:function(d){this.x-=d.x;this.y-=d.y;return this},multiplySelf:function(d){this.x*=d.x;this.y*=d.y;return this},multiplyScalar:function(d){this.x*=d;this.y*=d;return this},divideScalar:function(d){d?(this.x/=d,this.y/=d):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this.x*d.x+
this.y*d.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){var g=this.x-d.x;d=this.y-d.y;return g*g+d*d},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,g){return this.set((d.x-this.x)*
g+this.x,(d.y-this.y)*g+this.y)},isZero:function(){return 1E-4>this.length()}});var m={set:function(d,g){this._x=d;this._y=g;return this.trigger(Two.Events.change)},copy:function(d){this._x=d.x;this._y=d.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new p(this._x,this._y)},add:function(d,g){this._x=d.x+g.x;this._y=d.y+g.y;return this.trigger(Two.Events.change)},addSelf:function(d){this._x+=d.x;this._y+=
d.y;return this.trigger(Two.Events.change)},sub:function(d,g){this._x=d.x-g.x;this._y=d.y-g.y;return this.trigger(Two.Events.change)},subSelf:function(d){this._x-=d.x;this._y-=d.y;return this.trigger(Two.Events.change)},multiplySelf:function(d){this._x*=d.x;this._y*=d.y;return this.trigger(Two.Events.change)},multiplyScalar:function(d){this._x*=d;this._y*=d;return this.trigger(Two.Events.change)},divideScalar:function(d){return d?(this._x/=d,this._y/=d,this.trigger(Two.Events.change)):this.clear()},
negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this._x*d.x+this._y*d.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){var g=this._x-d.x;d=this._y-d.y;return g*g+d*d},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>
this.distanceTo(d)},lerp:function(d,g){return this.set((d.x-this._x)*g+this._x,(d.y-this._y)*g+this._y)},isZero:function(){return 1E-4>this.length()}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,m),this._bound=!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var p=Two.Commands,m=Two.Anchor=function(d,g,l,b,c,v,a){Two.Vector.call(this,d,g);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(a){this._command=a;this._command!==p.curve||_.isObject(this.controls)||m.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=a||p.move;if(!a)return this;m.AppendCurveProperties(this);_.isNumber(l)&&(this.controls.left.x=
l);_.isNumber(b)&&(this.controls.left.y=b);_.isNumber(c)&&(this.controls.right.x=c);_.isNumber(v)&&(this.controls.right.y=v)};_.extend(m,{AppendCurveProperties:function(d){var g=d._x||d.x,l=d._y||d.y;d.controls={left:new Two.Vector(g,l),right:new Two.Vector(g,l)}}});_.extend(m.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||m.AppendCurveProperties(this);_.each(this.controls,function(d){d.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(d){d.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){var d=this.controls;return new Two.Anchor(this.x,this.y,d&&d.left.x,d&&d.left.y,d&&d.right.x,d&&d.right.y,this.command)}})})();(function(){_.range(6);var p=Math.cos,m=Math.sin,d=Math.tan,g=Two.Matrix=function(d,b,c,g,a,k){this.elements=new Two.Array(9);var n=d;_.isArray(n)||(n=_.toArray(arguments));this.identity().set(n)};_.extend(g,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(d,b){if(3>=b.length){var c=b[0]||0,g=b[1]||0,a=b[2]||0;return{x:d[0]*c+d[1]*g+d[2]*a,y:d[3]*c+d[4]*g+d[5]*a,z:d[6]*c+d[7]*g+d[8]*a}}var c=d[0],g=d[1],a=d[2],k=d[3],n=d[4],q=d[5],w=d[6],f=d[7],r=d[8],m=b[0],p=b[1],u=b[2],x=b[3],s=b[4],t=b[5],e=b[6],
y=b[7],B=b[8];return[c*m+g*x+a*e,c*p+g*s+a*y,c*u+g*t+a*B,k*m+n*x+q*e,k*p+n*s+q*y,k*u+n*t+q*B,w*m+f*x+r*e,w*p+f*s+r*y,w*u+f*t+r*B]}});_.extend(g.prototype,Backbone.Events,{set:function(d,b,c,g,a,k){var n=d;_.isArray(n)||(n=_.toArray(arguments));_.each(n,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(g.Identity);return this},multiply:function(d,b,c,g,a,k,n,q,w){var f=arguments,r=f.length;if(1>=r)return _.each(this.elements,
function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=r)return d=d||0,b=b||0,c=c||0,a=this.elements,{x:a[0]*d+a[1]*b+a[2]*c,y:a[3]*d+a[4]*b+a[5]*c,z:a[6]*d+a[7]*b+a[8]*c};r=this.elements;A0=r[0];A1=r[1];A2=r[2];A3=r[3];A4=r[4];A5=r[5];A6=r[6];A7=r[7];A8=r[8];B0=f[0];B1=f[1];B2=f[2];B3=f[3];B4=f[4];B5=f[5];B6=f[6];B7=f[7];B8=f[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},inverse:function(d){var b=this.elements;d=d||new Two.Matrix;var c=b[0],g=b[1],a=b[2],k=b[3],n=b[4],q=b[5],w=b[6],f=b[7],b=b[8],r=b*n-q*f,m=-b*k+q*w,p=f*k-n*w,u=c*r+g*m+a*p;if(!u)return null;u=1/u;d.elements[0]=r*u;d.elements[1]=(-b*g+a*f)*u;d.elements[2]=(q*g-a*n)*u;d.elements[3]=m*u;d.elements[4]=(b*c-
a*w)*u;d.elements[5]=(-q*c+a*k)*u;d.elements[6]=p*u;d.elements[7]=(-f*c+g*w)*u;d.elements[8]=(n*c-g*k)*u;return d},scale:function(d,b){1>=arguments.length&&(b=d);return this.multiply(d,0,0,0,b,0,0,0,1)},rotate:function(d){var b=p(d);d=m(d);return this.multiply(b,-d,0,d,b,0,0,0,1)},translate:function(d,b){return this.multiply(1,0,d,0,1,b,0,0,1)},skewX:function(g){g=d(g);return this.multiply(1,g,0,0,1,0,0,0,1)},skewY:function(g){g=d(g);return this.multiply(1,0,0,g,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},
toArray:function(d){var b=this.elements,c=parseFloat(b[0].toFixed(3)),g=parseFloat(b[1].toFixed(3)),a=parseFloat(b[2].toFixed(3)),k=parseFloat(b[3].toFixed(3)),n=parseFloat(b[4].toFixed(3)),q=parseFloat(b[5].toFixed(3));if(d){d=parseFloat(b[6].toFixed(3));var w=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,k,d,g,n,w,a,q,b]}return[c,k,g,n,a,q]},clone:function(){return new Two.Matrix(this.elements[0],this.elements[1],this.elements[2],this.elements[3],this.elements[4],this.elements[5],
this.elements[6],this.elements[7],this.elements[8])}})})();(function(){function p(b){var c={},d=b.id,a=b.translation,k=b.rotation,n=b.scale,q=b.stroke,w=b.linewidth,f=b.fill,r=b.opacity,m=b.visible,p=b.cap,u=b.join,x=b.miter,s=b.closed,t=b.vertices;d&&(c.id=l.Identifier+d);a&&(_.isNumber(n)&&_.isNumber(k))&&(c.transform="matrix("+b._matrix.toString()+")");q&&(c.stroke=q);f&&(c.fill=f);r&&(c["stroke-opacity"]=c["fill-opacity"]=r);c.visibility=m?"visible":"hidden";p&&(c["stroke-linecap"]=p);u&&(c["stroke-linejoin"]=u);x&&(c["stroke-miterlimit"]=x);w&&(c["stroke-width"]=
w);t&&(c.d=g.toString(t,s));return c}function m(b,c,d,a){switch(c){case "matrix":c="transform";d="matrix("+d.toString()+")";break;case "visible":c="visibility";d=d?"visible":"hidden";break;case "cap":c="stroke-linecap";break;case "join":c="stroke-linejoin";break;case "miter":c="stroke-miterlimit";break;case "linewidth":c="stroke-width";break;case "vertices":c="d";d=g.toString(d,a);break;case "opacity":g.setAttributes(b,{"stroke-opacity":d,"fill-opacity":d});return}b.setAttribute(c,d)}var d=Two.Utils.mod,
g={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,c){var d=document.createElementNS(this.ns,b);"svg"===b&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&this.setAttributes(d,c);return d},setAttributes:function(b,c){_.each(c,function(b,a){this.setAttribute(a,b)},b);return this},removeAttributes:function(b,c){_.each(c,function(b){this.removeAttribute(b)},b);return this},toString:function(b,c){var g=b.length,a=g-1;return _.map(b,
function(k,n){var q,l=c?d(n-1,g):Math.max(n-1,0),f=c?d(n+1,g):Math.min(n+1,a),l=b[l],f=b[f],r,m,p,u,x;x=k.x.toFixed(3);u=k.y.toFixed(3);switch(k._command){case Two.Commands.close:q=k._command;break;case Two.Commands.curve:r=l.controls&&l.controls.right||l;q=k.controls&&k.controls.left||k;l=r.x.toFixed(3);r=r.y.toFixed(3);m=q.x.toFixed(3);p=q.y.toFixed(3);q=k._command+" "+l+" "+r+" "+m+" "+p+" "+x+" "+u;break;default:q=(k._command||(0===n?Two.Commands.move:Two.Commands.line))+" "+x+" "+u}n>=a&&c&&
(k._command===Two.Commands.curve&&(u=k.controls&&k.controls.right||k,x=f.controls&&f.controls.left||f,l=u.x.toFixed(3),r=u.y.toFixed(3),m=x.x.toFixed(3),p=x.y.toFixed(3),x=f.x.toFixed(3),u=f.y.toFixed(3),q+=" C "+l+" "+r+" "+m+" "+p+" "+x+" "+u),q+=" Z");return q}).join(" ")}},l=Two[Two.Types.svg]=function(){this.count=0;this.domElement=g.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},
this))};_.extend(l,{Identifier:"two-",Utils:g});_.extend(l.prototype,Backbone.Events,{setSize:function(b,c){this.width=b;this.height=c;g.setAttributes(this.domElement,{width:b,height:c});return this},add:function(b){var c=b,d=this.elements,a=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;if(_.isUndefined(b.id)){var q=this.count;this.count++;b.id=q}c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,
_.bind(this.update,this))),b=p(b),delete b.stroke,delete b.fill,delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=p(b));b=g.createElement(c,b);a.appendChild(b);d.push(b)},this);return this},update:function(b,c,d,a){var k=this.elements,g=k[b];switch(c){case Two.Properties.hierarchy:_.each(d,function(a){g.appendChild(k[a])});break;case Two.Properties.demotion:_.each(d,function(a){g.removeChild(k[a])});
break;default:m(g,c,d,a)}return this},render:function(){this.unveil();return this}})})();(function(){var p=Two.Utils.mod,m=function(b){_.each(b,function(b,d){this[d]=b},this);this.children=[]};_.extend(m.prototype,{appendChild:function(b){var c=b.parent;_.isUndefined(c)||c.removeChild(b);this.children.push(b);b.parent=this;return this},removeChild:function(b){b=_.indexOf(this.children,b);return 0>b?this:this.children.splice(b,1)[0]},render:function(b){var c=this.matrix;b.save();b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);_.each(this.children,function(c){c.render(b)});b.restore();return this}});
var d=function(b){_.each(b,function(b,d){this[d]=b},this)};_.extend(d.prototype,{render:function(b){var c=this.matrix,d=this.stroke,a=this.linewidth,k=this.fill,g=this.opacity,l=this.cap,w=this.join,f=this.miter,m=this.closed,A=this.commands,z=A.length,u=z-1;if(!this.visible)return this;b.save();c&&b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);k&&(b.fillStyle=k);d&&(b.strokeStyle=d);a&&(b.lineWidth=a);f&&(b.miterLimit=f);w&&(b.lineJoin=w);l&&(b.lineCap=l);_.isNumber(g)&&(b.globalAlpha=g);b.beginPath();
_.each(A,function(a,c){var k,e,d,f,g,n,l;l=a.x.toFixed(3);n=a.y.toFixed(3);switch(a._command){case Two.Commands.close:b.closePath();break;case Two.Commands.curve:e=m?p(c-1,z):Math.max(c-1,0);k=m?p(c+1,z):Math.min(c+1,u);e=A[e];k=A[k];d=e.controls&&e.controls.right||e;f=a.controls&&a.controls.left||a;e=d.x.toFixed(3);g=d.y.toFixed(3);d=f.x.toFixed(3);f=f.y.toFixed(3);b.bezierCurveTo(e,g,d,f,l,n);c>=u&&m&&(n=a.controls&&a.controls.right||a,l=k.controls&&k.controls.left||k,e=n.x.toFixed(3),g=n.y.toFixed(3),
d=l.x.toFixed(3),f=l.y.toFixed(3),l=k.x.toFixed(3),n=k.y.toFixed(3),b.bezierCurveTo(e,g,d,f,l,n));break;case Two.Commands.line:b.lineTo(l,n);break;case Two.Commands.move:b.moveTo(l,n)}});m&&b.closePath();b.fill();b.stroke();b.restore()}});var g={devicePixelRatio:this.devicePixelRatio||1,getBackingStoreRatio:function(b){return b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1},getRatio:function(b){return this.devicePixelRatio/
this.getBackingStoreRatio(b)}},l=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.elements=[];this.stage=null};_.extend(l,{Group:m,Element:d,getStyles:function(b){var c={},d=b.id,a=b._matrix,k=b.stroke,g=b.linewidth,l=b.fill,w=b.opacity,f=b.visible,m=b.cap,p=b.join,z=b.miter,u=b.closed;b=b.vertices;d&&(c.id=d);_.isObject(a)&&(c.matrix=a.toArray());k&&(c.stroke=k);l&&(c.fill=l);_.isNumber(w)&&
(c.opacity=w);m&&(c.cap=m);p&&(c.join=p);z&&(c.miter=z);g&&(c.linewidth=g);b&&(c.commands=b);c.visible=!!f;c.closed=!!u;return c},setStyles:function(b,c,d,a){switch(c){case "matrix":c="matrix";d=d.toArray();break;case "vertices":c="commands",b.closed=a}b[c]=d},Utils:g});_.extend(l.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?g.getRatio(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:b+"px",height:c+"px"});return this},add:function(b){constructor=Object.getPrototypeOf(this).constructor;var c=b,d=this.elements,a=constructor.Group,k=constructor.Element,g=constructor.getStyles;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;var f=_.isNull(this.stage);if(_.isUndefined(b.id)){var l=this.count;this.count++;b.id=l}c?(c=g.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,
delete c.linewidth,c=new a(c),f&&(this.stage=c,this.stage.object=b,this.stage.parent=b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new k(g.call(this,b));d.push(c);f||this.stage.appendChild(c)},this);return this},update:function(b,c,d,a,k){var g=Object.getPrototypeOf(this).constructor,l=this.elements,m=l[b];switch(c){case Two.Properties.hierarchy:_.each(d,function(a){m.appendChild(l[a])});break;case Two.Properties.demotion:_.each(d,function(a){m.removeChild(l[a]);
this.elements[a]=null},this);break;default:g.setStyles.call(this,m,c,d,a,k)}return this},render:function(){if(_.isNull(this.stage))return this;var b=1===this.ratio;b||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);b||this.ctx.restore();return this}})})();(function(){function p(a,b){var c=Math.min(a.top,b.top),d=Math.min(a.left,b.left),g=Math.max(a.right,b.right),f=Math.max(a.bottom,b.bottom);return{top:c,left:d,right:g,bottom:f,width:g-d,height:f-c,centroid:{x:-d,y:-c}}}var m=Two[Two.Types.canvas],d=Two.Matrix.Multiply,g=Two.Utils.mod,l=function(a){m.Group.call(this,a)};_.extend(l.prototype,m.Group.prototype,{appendChild:function(){m.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},updateTexture:function(a){_.each(this.children,
function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=d(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var b=function(a){m.Element.call(this,a)};_.extend(b.prototype,m.Element.prototype,{updateMatrix:function(a){var b=
a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=d(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){c.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this.texture);a.uniformMatrix3fv(b.matrix,
!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var c={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b){var c=Infinity,d=-Infinity,g=Infinity,f=-Infinity;_.each(a,function(a,b){var k=a.x,l=a.y,m,p;m=a.controls;g=Math.min(l,g);c=Math.min(k,c);d=Math.max(k,d);f=Math.max(l,f);a.controls&&(k=m.left,p=m.right,k&&p&&(m=k.x,k=k.y,
l=p.x,p=p.y,m&&(k&&l&&p)&&(g=Math.min(k,p,g),c=Math.min(m,l,c),d=Math.max(m,l,d),f=Math.max(k,p,f))))});_.isNumber(b)&&(g-=b,c-=b,d+=b,f+=b);return{top:g,left:c,right:d,bottom:f,width:d-c,height:f-g,centroid:{x:-c,y:-g}}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right;a=a.bottom;return new Two.Array([c,b,d,b,c,a,c,a,d,b,d,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,d=this.ctx,l=a._scale,f=a.stroke,m=a.linewidth*l,p=a.fill,v=a.opacity,u=a.cap,x=a.join,s=a.miter,t=a.closed,
e=b.length,y=e-1;c.width=Math.max(Math.ceil(a.rect.width*l),1);c.height=Math.max(Math.ceil(a.rect.height*l),1);a=a.rect.centroid;var B=a.x*l,D=a.y*l;d.clearRect(0,0,c.width,c.height);p&&(d.fillStyle=p);f&&(d.strokeStyle=f);m&&(d.lineWidth=m);s&&(d.miterLimit=s);x&&(d.lineJoin=x);u&&(d.lineCap=u);_.isNumber(v)&&(d.globalAlpha=v);d.beginPath();_.each(b,function(a,c){var f,n,m,p,r,v,s;s=(a.x*l+B).toFixed(3);v=(a.y*l+D).toFixed(3);switch(a._command){case Two.Commands.close:d.closePath();break;case Two.Commands.curve:n=
t?g(c-1,e):Math.max(c-1,0);f=t?g(c+1,e):Math.min(c+1,y);n=b[n];f=b[f];m=n.controls&&n.controls.right||n;p=a.controls&&a.controls.left||a;n=(m.x*l+B).toFixed(3);r=(m.y*l+D).toFixed(3);m=(p.x*l+B).toFixed(3);p=(p.y*l+D).toFixed(3);d.bezierCurveTo(n,r,m,p,s,v);c>=y&&t&&(v=a.controls&&a.controls.right||a,s=f.controls&&f.controls.left||f,n=(v.x*l+B).toFixed(3),r=(v.y*l+D).toFixed(3),m=(s.x*l+B).toFixed(3),p=(s.y*l+D).toFixed(3),s=(f.x*l+B).toFixed(3),v=(f.y*l+D).toFixed(3),d.bezierCurveTo(n,r,m,p,s,v));
break;case Two.Commands.line:d.lineTo(s,v);break;case Two.Commands.move:d.moveTo(s,v)}});t&&d.closePath();d.fill();d.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);
a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=
a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};c.ctx=c.canvas.getContext("2d");var v=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;this._matrix=[1,0,0,0,1,0,0,0,1];this._scale=1;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",
a)||this.domElement.getContext("experimental-webgl",a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=c.shaders.create(a,c.shaders.vertex,c.shaders.types.vertex),d=c.shaders.create(a,c.shaders.fragment,c.shaders.types.fragment);this.program=c.program.create(a,[b,d]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=
a.getAttribLocation(this.program,"a_textureCoords");a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(v,{Group:l,Element:b,getStyles:function(a){var d={},g=a.id,l=a._matrix,m=a.stroke,f=a.linewidth,p=a.fill,v=a.opacity,z=a.visible,u=a.cap,x=a.join,s=a.miter,t=a.closed,e=a.vertices;g&&(d.id=g);_.isObject(l)&&(d.matrix=d._matrix=l.toArray(!0),d.scale=d._scale=1);m&&(d.stroke=
m);p&&(d.fill=p);_.isNumber(v)&&(d.opacity=v);u&&(d.cap=u);x&&(d.join=x);s&&(d.miter=s);f&&(d.linewidth=f);e&&(d.vertices=e,d.commands=d.vertices,d.rect=c.getBoundingClientRect(d.commands,d.linewidth),d.triangles=c.getTriangles(d.rect));d.visible=!!z;d.closed=!!t;a instanceof Two.Polygon&&(c.updateBuffer(this.ctx,d,this.program),b.prototype.updateTexture.call(d,this.ctx));return d},setStyles:function(a,b,d,g,l){var f=!1;/matrix/.test(b)?(a[b]=d.toArray(!0),_.isNumber(g)&&(f=a.scale!==g,a.scale=g),
a.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=d,a.rect=p(c.getBoundingClientRect(a.commands,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),f=!0):"vertices"===b?(_.isUndefined(g)||(a.closed=g),l?a.commands=d:(a.vertices=d,a.commands=a.vertices),a.rect=p(c.getBoundingClientRect(a.vertices,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),f=!0):a[b]=d;f&&a.updateTexture(this.ctx)}});
_.extend(v.prototype,Backbone.Events,m.prototype,{setSize:function(a,b,c){m.prototype.setSize.apply(this,arguments);a*=this.ratio;b*=this.ratio;this._matrix[0]=this._matrix[4]=this._scale=this.ratio;_.isNull(this.stage)||this.stage.updateMatrix();this.ctx.viewport(0,0,a,b);var d=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(d,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var p=Two.Shape=function(m){this._matrix=new Two.Matrix;var d=_.debounce(_.bind(function(){var d=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",d,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(g){this._rotation=g;d()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(g){this._scale=g;d()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,d);if(m)return this;p.MakeGetterSetter(this,p.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4};_.extend(p,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(m,d){_.isArray(d)||(d=[d]);_.each(d,function(d){var l="_"+d;Object.defineProperty(m,
d,{get:function(){return this[l]},set:function(b){this[l]=b;this.trigger(Two.Events.change,this.id,d,b,this)}})})}});_.extend(p.prototype,Backbone.Events,{addTo:function(m){m.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var m=new p;m.translation.copy(this.translation);_.each(p.Properties,function(d){m[d]=this[d]},this);return this}})})();(function(){var p=Math.min,m=Math.max,d=Two.Group=function(g){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;d.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(d,{MakeGetterSetter:function(d,l){_.isArray(l)||(l=[l]);_.each(l,function(b){var c="_"+b;Object.defineProperty(d,b,{get:function(){return this[c]},set:function(d){this[c]=d;_.each(this.children,function(a){a[b]=d})}})})}});
_.extend(d.prototype,Two.Shape.prototype,{clone:function(g){g=g||this.parent;var l=_.map(this.children,function(b){return b.clone(g)}),b=new d;g.add(b);b.add(l);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},corner:function(){var d=this.getBoundingClientRect(!0),l={x:d.left,y:d.top};_.each(this.children,function(b){b.translation.subSelf(l)});return this},center:function(){var d=this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/
2};_.each(this.children,function(l){l.translation.subSelf(d.centroid)});return this},add:function(d){var l=d,b=this.children,c=this.parent,m=[];_.isArray(d)||(l=_.toArray(arguments));var a=_.bind(function(a,b,c,d,f){this.trigger(Two.Events.change,a,b,c,d,f)},this);_.each(l,function(d){if(d){var g=d.id,l=d.parent;_.isUndefined(g)&&(c.add(d),g=d.id);_.isUndefined(b[g])&&(l&&delete l.children[g],b[g]=d,d.parent=this,d.unbind(Two.Events.change).bind(Two.Events.change,a),m.push(g))}},this);0<m.length&&
this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,m);return this},remove:function(d){var l=d,b=this.children,c=this.parent,m=[];if(0>=arguments.length&&c)return c.remove(this),this;_.isArray(d)||(l=_.toArray(arguments));_.each(l,function(a){var c=a.id;c in b&&(delete b[c],delete a.parent,a.unbind(Two.Events.change),m.push(c))});0<m.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,m);return this},getBoundingClientRect:function(d){var l=Infinity,b=-Infinity,c=Infinity,
v=-Infinity;_.each(this.children,function(a){a=a.getBoundingClientRect(!0);_.isNumber(a.top)&&(_.isNumber(a.left)&&_.isNumber(a.right)&&_.isNumber(a.bottom))&&(c=p(a.top,c),l=p(a.left,l),b=m(a.right,b),v=m(a.bottom,v))},this);var a=d?this._matrix:Two.Utils.getComputedMatrix(this);d=a.multiply(l,c,1);var k=a.multiply(b,c,1),n=a.multiply(b,v,1),a=a.multiply(l,v,1),c=p(d.y,k.y,n.y,a.y),l=p(d.x,k.x,n.x,a.x),b=m(d.x,k.x,n.x,a.x),v=m(d.y,k.y,n.y,a.y);return{top:c,left:l,right:b,bottom:v,width:b-l,height:v-
c}},noFill:function(){_.each(this.children,function(d){d.noFill()});return this},noStroke:function(){_.each(this.children,function(d){d.noStroke()});return this},subdivide:function(){_.each(this.children,function(d){d.subdivide()});return this}})})();(function(){var p=Math.min,m=Math.max,d=Math.round,g=Two.Polygon=function(l,b,c,g){Two.Shape.call(this);this._closed=!!b;this._curved=!!c;this._automatic=!g;var a=0,k=1,n=!1,q=!1,w,f=[],r=_.debounce(_.bind(function(b){var c;this._automatic&&this.plot();if(n||q)for(b=w.length,c=b-1,b=d(a*c),c=d(k*c),f.length=0;b<c+1;b++)f.push(w[b]);this.trigger(Two.Events.change,this.id,"vertices",f,this._closed,n);q=n=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(a){this._closed=
!!a;r()}});Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;r()}});Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(a){if(a!==this._automatic){var b=(this._automatic=!!a)?"ignore":"listen";_.each(this.vertices,function(a){a[b]()},this);r()}}});Object.defineProperty(this,"beginning",{get:function(){return a},set:function(b){a=p(m(b,0),1);n=!0;r()}});Object.defineProperty(this,"ending",{get:function(){return k},
set:function(a){k=p(m(a,0),1);n=!0;r()}});Object.defineProperty(this,"vertices",{get:function(){return w},set:function(a){var b=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,r)},this);q=!0;r()},this),c=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,r)},this);q=!0;r()},this);w&&w.unbind();w=new Two.Utils.Collection(a.slice(0));w.bind(Two.Events.insert,b);w.bind(Two.Events.remove,c);q=!0;b(w)}});this.vertices=l;if(this._automatic)return this.plot(),this;_.each(this.vertices,
function(a){_.isFunction(a.listen)&&a.listen()})};_.extend(g.prototype,Two.Shape.prototype,{clone:function(){var d=_.map(this.vertices,function(b){return b.clone()}),b=new g(d,this._closed,this._curved);_.each(Two.Shape.Properties,function(c){b[c]=this[c]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},corner:function(){var d=this.getBoundingClientRect(!0),b={x:d.left,y:d.top};_.each(this.vertices,function(c){c.subSelf(b)});return this},center:function(){var d=
this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/2};_.each(this.vertices,function(b){b.subSelf(d.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(d){var b=this.linewidth/2,c=Infinity,g=-Infinity,a=Infinity,k=-Infinity;_.each(this.vertices,function(b){var d=b.x;b=b.y;a=p(b,a);c=p(d,c);g=m(d,g);k=m(b,k)});var a=a-b,c=c-b,g=g+b,k=k+b,n=d?this._matrix:Two.Utils.getComputedMatrix(this);
d=n.multiply(c,a,1);var b=n.multiply(g,a,1),q=n.multiply(g,k,1),n=n.multiply(c,k,1),a=p(d.y,b.y,q.y,n.y),c=p(d.x,b.x,q.x,n.x),g=m(d.x,b.x,q.x,n.x),k=m(d.y,b.y,q.y,n.y);return{top:a,left:c,right:g,bottom:k,width:g-c,height:k-a}},plot:function(){if(this._curved)return Two.Utils.getCurveFromPoints(this.vertices,this._closed),this;_.each(this.vertices,function(d,b){d._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){var d=this.vertices.length-1,b=this._closed||
this.vertices[d].command===Two.Commands.close,c=[],g;_.each(this.vertices,function(a,d){var l,m,p,f,r,A,z,u;0>=d&&!b||(l=g.x,m=g.y,p=(g.controls&&g.controls.right||g).x,f=(g.controls&&g.controls.right||g).y,r=(a.controls&&a.controls.left||a).x,A=(a.controls&&a.controls.left||a).y,z=a.x,u=a.y,c.push(Two.Utils.subdivide(l,m,p,f,r,A,z,u)));g=a},this);this._curved=this._manual=!1;this.vertices=_.flatten(c);this.plot();return this}})})();
