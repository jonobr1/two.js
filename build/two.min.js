(function(){function q(l,a,b){if(l===a)return 0!==l||1/l==1/a;if(null==l||null==a)return l===a;l._chain&&(l=l._wrapped);a._chain&&(a=a._wrapped);if(l.isEqual&&d.isFunction(l.isEqual))return l.isEqual(a);if(a.isEqual&&d.isFunction(a.isEqual))return a.isEqual(l);var c=n.call(l);if(c!=n.call(a))return!1;switch(c){case "[object String]":return l==String(a);case "[object Number]":return l!=+l?a!=+a:0==l?1/l==1/a:l==+a;case "[object Date]":case "[object Boolean]":return+l==+a;case "[object RegExp]":return l.source==
a.source&&l.global==a.global&&l.multiline==a.multiline&&l.ignoreCase==a.ignoreCase}if("object"!=typeof l||"object"!=typeof a)return!1;for(var f=b.length;f--;)if(b[f]==l)return!0;b.push(l);var f=0,k=!0;if("[object Array]"==c){if(f=l.length,k=f==a.length)for(;f--&&(k=f in l==f in a&&q(l[f],a[f],b)););}else{if("constructor"in l!="constructor"in a||l.constructor!=a.constructor)return!1;for(var e in l)if(d.has(l,e)&&(f++,!(k=d.has(a,e)&&q(l[e],a[e],b))))break;if(k){for(e in a)if(d.has(a,e)&&!f--)break;
k=!f}}b.pop();return k}var h=this,p=h._,m={},g=Array.prototype,e=Object.prototype,b=g.slice,c=g.unshift,n=e.toString,a=e.hasOwnProperty,k=g.forEach,v=g.map,r=g.reduce,f=g.reduceRight,y=g.filter,D=g.every,z=g.some,s=g.indexOf,x=g.lastIndexOf,e=Array.isArray,t=Object.keys,u=Function.prototype.bind,d=function(l){return new H(l)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):h._=d;d.VERSION="1.3.3";var w=d.each=d.forEach=function(l,
a,b){if(null!=l)if(k&&l.forEach===k)l.forEach(a,b);else if(l.length===+l.length)for(var c=0,f=l.length;c<f&&!(c in l&&a.call(b,l[c],c,l)===m);c++);else for(c in l)if(d.has(l,c)&&a.call(b,l[c],c,l)===m)break};d.map=d.collect=function(l,d,a){var b=[];if(null==l)return b;if(v&&l.map===v)return l.map(d,a);w(l,function(l,c,f){b[b.length]=d.call(a,l,c,f)});l.length===+l.length&&(b.length=l.length);return b};d.reduce=d.foldl=d.inject=function(l,a,b,c){var f=2<arguments.length;null==l&&(l=[]);if(r&&l.reduce===
r)return c&&(a=d.bind(a,c)),f?l.reduce(a,b):l.reduce(a);w(l,function(l,d,k){f?b=a.call(c,b,l,d,k):(b=l,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return b};d.reduceRight=d.foldr=function(l,a,b,c){var k=2<arguments.length;null==l&&(l=[]);if(f&&l.reduceRight===f)return c&&(a=d.bind(a,c)),k?l.reduceRight(a,b):l.reduceRight(a);var e=d.toArray(l).reverse();c&&!k&&(a=d.bind(a,c));return k?d.reduce(e,a,b,c):d.reduce(e,a)};d.find=d.detect=function(l,a,d){var b;A(l,function(l,
c,f){if(a.call(d,l,c,f))return b=l,!0});return b};d.filter=d.select=function(l,a,d){var b=[];if(null==l)return b;if(y&&l.filter===y)return l.filter(a,d);w(l,function(l,c,f){a.call(d,l,c,f)&&(b[b.length]=l)});return b};d.reject=function(l,a,d){var b=[];if(null==l)return b;w(l,function(l,c,f){a.call(d,l,c,f)||(b[b.length]=l)});return b};d.every=d.all=function(l,a,d){var b=!0;if(null==l)return b;if(D&&l.every===D)return l.every(a,d);w(l,function(l,c,f){if(!(b=b&&a.call(d,l,c,f)))return m});return!!b};
var A=d.some=d.any=function(l,a,b){a||(a=d.identity);var c=!1;if(null==l)return c;if(z&&l.some===z)return l.some(a,b);w(l,function(l,d,f){if(c||(c=a.call(b,l,d,f)))return m});return!!c};d.include=d.contains=function(l,a){var d=!1;return null==l?d:s&&l.indexOf===s?-1!=l.indexOf(a):d=A(l,function(l){return l===a})};d.invoke=function(a,c){var f=b.call(arguments,2);return d.map(a,function(a){return(d.isFunction(c)?c||a:a[c]).apply(a,f)})};d.pluck=function(a,b){return d.map(a,function(a){return a[b]})};
d.max=function(a,b,c){if(!b&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&d.isEmpty(a))return-Infinity;var f={computed:-Infinity};w(a,function(a,d,l){d=b?b.call(c,a,d,l):a;d>=f.computed&&(f={value:a,computed:d})});return f.value};d.min=function(a,b,c){if(!b&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&d.isEmpty(a))return Infinity;var f={computed:Infinity};w(a,function(a,d,l){d=b?b.call(c,a,d,l):a;d<f.computed&&(f={value:a,computed:d})});return f.value};d.shuffle=
function(a){var d=[],b;w(a,function(a,l,c){b=Math.floor(Math.random()*(l+1));d[l]=d[b];d[b]=a});return d};d.sortBy=function(a,b,c){var f=d.isFunction(b)?b:function(a){return a[b]};return d.pluck(d.map(a,function(a,d,l){return{value:a,criteria:f.call(c,a,d,l)}}).sort(function(a,d){var l=a.criteria,b=d.criteria;return void 0===l?1:void 0===b?-1:l<b?-1:l>b?1:0}),"value")};d.groupBy=function(a,b){var c={},f=d.isFunction(b)?b:function(a){return a[b]};w(a,function(a,d){var l=f(a,d);(c[l]||(c[l]=[])).push(a)});
return c};d.sortedIndex=function(a,b,c){c||(c=d.identity);for(var f=0,k=a.length;f<k;){var e=f+k>>1;c(a[e])<c(b)?f=e+1:k=e}return f};d.toArray=function(a){return a?d.isArray(a)||d.isArguments(a)?b.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a):[]};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,d,c){return null==d||c?a[0]:b.call(a,0,d)};d.initial=function(a,d,c){return b.call(a,0,a.length-(null==d||c?1:d))};d.last=function(a,d,
c){return null==d||c?a[a.length-1]:b.call(a,Math.max(a.length-d,0))};d.rest=d.tail=function(a,d,c){return b.call(a,null==d||c?1:d)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,b){return d.reduce(a,function(a,l){if(d.isArray(l))return a.concat(b?l:d.flatten(l));a[a.length]=l;return a},[])};d.without=function(a){return d.difference(a,b.call(arguments,1))};d.uniq=d.unique=function(a,b,c){c=c?d.map(a,c):a;var f=[];3>a.length&&(b=!0);d.reduce(c,function(c,k,e){(b?
d.last(c)===k&&c.length:d.include(c,k))||(c.push(k),f.push(a[e]));return c},[]);return f};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var c=b.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(c,function(l){return 0<=d.indexOf(l,a)})})};d.difference=function(a){var c=d.flatten(b.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(c,a)})};d.zip=function(){for(var a=b.call(arguments),c=d.max(d.pluck(a,"length")),
f=Array(c),k=0;k<c;k++)f[k]=d.pluck(a,""+k);return f};d.indexOf=function(a,b,c){if(null==a)return-1;var f;if(c)return c=d.sortedIndex(a,b),a[c]===b?c:-1;if(s&&a.indexOf===s)return a.indexOf(b);c=0;for(f=a.length;c<f;c++)if(c in a&&a[c]===b)return c;return-1};d.lastIndexOf=function(a,d){if(null==a)return-1;if(x&&a.lastIndexOf===x)return a.lastIndexOf(d);for(var b=a.length;b--;)if(b in a&&a[b]===d)return b;return-1};d.range=function(a,d,b){1>=arguments.length&&(d=a||0,a=0);b=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-a)/b),0),f=0,k=Array(c);f<c;)k[f++]=a,a+=b;return k};var L=function(){};d.bind=function(a,c){var f,k;if(a.bind===u&&u)return u.apply(a,b.call(arguments,1));if(!d.isFunction(a))throw new TypeError;k=b.call(arguments,2);return f=function(){if(!(this instanceof f))return a.apply(c,k.concat(b.call(arguments)));L.prototype=a.prototype;var d=new L,e=a.apply(d,k.concat(b.call(arguments)));return Object(e)===e?e:d}};d.bindAll=function(a){var c=b.call(arguments,1);0==c.length&&(c=d.functions(a));
w(c,function(b){a[b]=d.bind(a[b],a)});return a};d.memoize=function(a,b){var c={};b||(b=d.identity);return function(){var f=b.apply(this,arguments);return d.has(c,f)?c[f]:c[f]=a.apply(this,arguments)}};d.delay=function(a,d){var c=b.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},d)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(b.call(arguments,1)))};d.throttle=function(a,b){var c,f,k,e,t,u,n=d.debounce(function(){t=e=!1},b);return function(){c=this;f=arguments;k||
(k=setTimeout(function(){k=null;t&&a.apply(c,f);n()},b));e?t=!0:u=a.apply(c,f);n();e=!0;return u}};d.debounce=function(a,d,b){var c;return function(){var f=this,k=arguments;b&&!c&&a.apply(f,k);clearTimeout(c);c=setTimeout(function(){c=null;b||a.apply(f,k)},d)}};d.once=function(a){var d=!1,b;return function(){if(d)return b;d=!0;return b=a.apply(this,arguments)}};d.wrap=function(a,d){return function(){var c=[a].concat(b.call(arguments,0));return d.apply(this,c)}};d.compose=function(){var a=arguments;
return function(){for(var d=arguments,b=a.length-1;0<=b;b--)d=[a[b].apply(this,d)];return d[0]}};d.after=function(a,d){return 0>=a?d():function(){if(1>--a)return d.apply(this,arguments)}};d.keys=t||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)d.has(a,c)&&(b[b.length]=c);return b};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var b=[],c;for(c in a)d.isFunction(a[c])&&b.push(c);return b.sort()};d.extend=function(a){w(b.call(arguments,
1),function(d){for(var b in d)a[b]=d[b]});return a};d.pick=function(a){var c={};w(d.flatten(b.call(arguments,1)),function(d){d in a&&(c[d]=a[d])});return c};d.defaults=function(a){w(b.call(arguments,1),function(d){for(var b in d)null==a[b]&&(a[b]=d[b])});return a};d.clone=function(a){return d.isObject(a)?d.isArray(a)?a.slice():d.extend({},a):a};d.tap=function(a,d){d(a);return a};d.isEqual=function(a,d){return q(a,d,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===
a.length;for(var b in a)if(d.has(a,b))return!1;return!0};d.isElement=function(a){return!(!a||1!=a.nodeType)};d.isArray=e||function(a){return"[object Array]"==n.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==n.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==n.call(a)};d.isString=function(a){return"[object String]"==n.call(a)};d.isNumber=function(a){return"[object Number]"==
n.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};d.isDate=function(a){return"[object Date]"==n.call(a)};d.isRegExp=function(a){return"[object RegExp]"==n.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(d,b){return a.call(d,b)};d.noConflict=function(){h._=p;return this};d.identity=function(a){return a};d.times=
function(a,d,b){for(var c=0;c<a;c++)d.call(b,c)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,b){if(null==a)return null;var c=a[b];return d.isFunction(c)?c.call(a):c};d.mixin=function(a){w(d.functions(a),function(b){I(b,d[b]=a[b])})};var G=0;d.uniqueId=function(a){var d=G++;return a?a+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var C=/.^/,M={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},N;for(N in M)M[M[N]]=N;var U=/\\|'|\r|\n|\t|\u2028|\u2029/g,V=/\\(\\|'|r|n|t|u2028|u2029)/g,O=function(a){return a.replace(V,function(a,d){return M[d]})};d.template=function(a,b,c){c=d.defaults(c||{},d.templateSettings);a="__p+='"+a.replace(U,function(a){return"\\"+M[a]}).replace(c.escape||C,function(a,d){return"'+\n_.escape("+O(d)+")+\n'"}).replace(c.interpolate||C,function(a,d){return"'+\n("+
O(d)+")+\n'"}).replace(c.evaluate||C,function(a,d){return"';\n"+O(d)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var f=new Function(c.variable||"obj","_",a);if(b)return f(b,d);b=function(a){return f.call(this,a,d)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};d.chain=function(a){return d(a).chain()};var H=function(a){this._wrapped=a};d.prototype=H.prototype;
var P=function(a,b){return b?d(a).chain():a},I=function(a,f){H.prototype[a]=function(){var a=b.call(arguments);c.call(a,this._wrapped);return P(f.apply(d,a),this._chain)}};d.mixin(d);w("pop push reverse shift sort splice unshift".split(" "),function(a){var d=g[a];H.prototype[a]=function(){var b=this._wrapped;d.apply(b,arguments);var c=b.length;"shift"!=a&&"splice"!=a||0!==c||delete b[0];return P(b,this._chain)}});w(["concat","join","slice"],function(a){var d=g[a];H.prototype[a]=function(){return P(d.apply(this._wrapped,
arguments),this._chain)}});H.prototype.chain=function(){this._chain=!0;return this};H.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var q=[].slice,h=/\s+/,p=function(e,b,c,n){if(!c)return!0;if("object"===typeof c)for(var a in c)e[b].apply(e,[a,c[a]].concat(n));else if(h.test(c)){c=c.split(h);a=0;for(var k=c.length;a<k;a++)e[b].apply(e,[c[a]].concat(n))}else return!0},m=function(e,b,c){var n;e=-1;var a=b.length;switch(c.length){case 0:for(;++e<a;)(n=b[e]).callback.call(n.ctx);break;case 1:for(;++e<a;)(n=b[e]).callback.call(n.ctx,c[0]);break;case 2:for(;++e<a;)(n=b[e]).callback.call(n.ctx,c[0],c[1]);break;case 3:for(;++e<
a;)(n=b[e]).callback.call(n.ctx,c[0],c[1],c[2]);break;default:for(;++e<a;)(n=b[e]).callback.apply(n.ctx,c)}},g=Backbone.Events={on:function(e,b,c){if(!p(this,"on",e,[b,c])||!b)return this;this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:b,context:c,ctx:c||this});return this},once:function(e,b,c){if(!p(this,"once",e,[b,c])||!b)return this;var n=this,a=_.once(function(){n.off(e,a);b.apply(this,arguments)});a._callback=b;this.on(e,a,c);return this},off:function(e,
b,c){var n,a,k,g,h,f,y,m;if(!this._events||!p(this,"off",e,[b,c]))return this;if(!e&&!b&&!c)return this._events={},this;g=e?[e]:_.keys(this._events);h=0;for(f=g.length;h<f;h++)if(e=g[h],n=this._events[e]){k=[];if(b||c)for(y=0,m=n.length;y<m;y++)a=n[y],(b&&b!==(a.callback._callback||a.callback)||c&&c!==a.context)&&k.push(a);this._events[e]=k}return this},trigger:function(e){if(!this._events)return this;var b=q.call(arguments,1);if(!p(this,"trigger",e,b))return this;var c=this._events[e],n=this._events.all;
c&&m(this,c,b);n&&m(this,n,arguments);return this},listenTo:function(e,b,c){var n=this._listeners||(this._listeners={}),a=e._listenerId||(e._listenerId=_.uniqueId("l"));n[a]=e;e.on(b,c||this,this);return this},stopListening:function(e,b,c){var n=this._listeners;if(n){if(e)e.off(b,c,this),b||c||delete n[e._listenerId];else{for(var a in n)n[a].off(null,null,this);this._listeners={}}return this}}};g.bind=g.on;g.unbind=g.off})();(function(){for(var q=0,h=["ms","moz","webkit","o"],p=0;p<h.length&&!window.requestAnimationFrame;++p)window.requestAnimationFrame=window[h[p]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[h[p]+"CancelAnimationFrame"]||window[h[p]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(h,g){var e=(new Date).getTime(),b=Math.max(0,16-(e-q)),c=window.setTimeout(function(){h(e+b)},b);q=e+b;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(h){clearTimeout(h)})})();(function(){function q(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(f.Events.resize,b,a)}var h=this,p=h.Two||{},m=Math.sin,g=Math.cos,e=Math.atan2,b=Math.sqrt,c=Math.abs,n=Math.PI,a=2*n,k=n/2,v=Math.pow,r={hasEventListeners:_.isFunction(h.addEventListener),bind:function(a,b,d,c){this.hasEventListeners?a.addEventListener(b,d,!!c):a.attachEvent("on"+b,d);return this},unbind:function(a,b,d,c){this.hasEventListeners?
a.removeEventListeners(b,d,!!c):a.detachEvent("on"+b,d);return this}},f=h.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:f.Types.svg,autostart:!1});this.type=a.type;this.renderer=new f[this.type](this);f.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(q,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),r.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new f.Group;this.renderer.add(this.scene);f.Instances.push(this)};_.extend(f,{Array:h.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.2.1",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},
Resolution:8,Instances:[],noConflict:function(){h.Two=p;return this},Utils:{Curve:{CollinearityEpsilon:v(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},getComputedMatrix:function(a){for(var b=new f.Matrix;a&&a._matrix;){var d=a._matrix.elements;b.multiply(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9]);a=a.parent}return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";
_.each(a.attributes,function(a,c){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return f.Utils.read.g.apply(this,
arguments)},g:function(a){var b=new f.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in f.Utils.read&&(a=f.Utils.read[c].call(this,a),b.add(a))}},this);return f.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var d=a.points;if(d){var c=_.map(_.range(d.numberOfItems),function(a){a=d.getItem(a);return new f.Vector(a.x,a.y)}),c=(new f.Polygon(c,!b)).noStroke();return f.Utils.applySvgAttributes(a,c)}},polyline:function(a){return f.Utils.read.polygon(a,
!0)},path:function(a){var b=a.getAttribute("d"),b=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){a=_.map(_.compact(a.split(/m/g)),function(a,d){return 0>=d?a:"m"+a});a[0]="M"+a[0];return a})),d=new f.Vector,c=new f.Vector;return _.map(b,function(b){var k,e=!1,n=!1;b=_.flatten(_.map(b.match(/[a-z][^a-z]*/ig),function(a){var b,g,h=a[0],t=h.toLowerCase();k=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/);e=h===t;var u,r,v;switch(t){case "z":n=!0;break;case "m":case "l":g=parseFloat(k[0]);b=parseFloat(k[1]);
b=new f.Vector(g,b);e&&b.addSelf(d);d.copy(b);break;case "h":case "v":g="h"===t?"x":"y";a="x"===g?"y":"x";b=new f.Vector;b[g]=parseFloat(k[0]);b[a]=d[a];e&&(b[g]+=d[g]);d.copy(b);break;case "s":case "c":b=d.x;a=d.y;"c"===t?(h=parseFloat(k[0]),g=parseFloat(k[1]),t=parseFloat(k[2]),u=parseFloat(k[3]),r=parseFloat(k[4]),v=parseFloat(k[5])):(u=(new f.Vector).copy(d).subSelf(c),h=parseFloat(u.x),g=parseFloat(u.y),t=parseFloat(k[0]),u=parseFloat(k[1]),r=parseFloat(k[2]),v=parseFloat(k[3]));e&&(h+=b,g+=
a,t+=b,u+=a,r+=b,v+=a);b=f.Utils.subdivide(b,a,h,g,t,u,r,v);d.set(r,v);c.set(t,u);break;case "t":case "q":b=d.x;a=d.y;c.isZero()?(h=b,g=a):(h=c.x,a=c.y);"q"===t?(t=parseFloat(k[0]),u=parseFloat(k[1]),r=parseFloat(k[1]),v=parseFloat(k[2])):(u=(new f.Vector).copy(d).subSelf(c),t=parseFloat(u.x),u=parseFloat(u.y),r=parseFloat(k[0]),v=parseFloat(k[1]));e&&(h+=b,g+=a,t+=b,u+=a,r+=b,v+=a);b=f.Utils.subdivide(b,a,h,g,t,u,r,v);d.set(r,v);c.set(t,u);break;case "a":throw new f.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return b}));_.isUndefined(b[b.length-1])&&b.pop();b=(new f.Polygon(b,n)).noStroke();return f.Utils.applySvgAttributes(a,b)})},circle:function(b){var c=parseFloat(b.getAttribute("cx")),d=parseFloat(b.getAttribute("cy")),k=parseFloat(b.getAttribute("r")),e=f.Resolution,n=_.map(_.range(e),function(b){var d=b/e*a;b=k*g(d);d=k*m(d);return new f.Vector(b,d)},this),n=(new f.Polygon(n,!0,!0)).noStroke();n.translation.set(c,d);return f.Utils.applySvgAttributes(b,n)},ellipse:function(b){var c=parseFloat(b.getAttribute("cx")),
d=parseFloat(b.getAttribute("cy")),k=parseFloat(b.getAttribute("rx")),e=parseFloat(b.getAttribute("ry")),n=f.Resolution,h=_.map(_.range(n),function(b){var d=b/n*a;b=k*g(d);d=e*m(d);return new f.Vector(b,d)},this),h=(new f.Polygon(h,!0,!0)).noStroke();h.translation.set(c,d);return f.Utils.applySvgAttributes(b,h)},rect:function(a){var b=parseFloat(a.getAttribute("x")),d=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),k=parseFloat(a.getAttribute("height")),c=c/2,k=k/2,e=[new f.Vector(c,
k),new f.Vector(-c,k),new f.Vector(-c,-k),new f.Vector(c,-k)],e=(new f.Polygon(e,!0)).noStroke();e.translation.set(b+c,d+k);return f.Utils.applySvgAttributes(a,e)},line:function(a){var b=parseFloat(a.getAttribute("x1")),d=parseFloat(a.getAttribute("y1")),c=parseFloat(a.getAttribute("x2")),k=parseFloat(a.getAttribute("y2")),c=(c-b)/2,k=(k-d)/2,e=[new f.Vector(-c,-k),new f.Vector(c,k)],e=(new f.Polygon(e)).noFill();e.translation.set(b+c,d+k);return f.Utils.applySvgAttributes(a,e)}},subdivide:function(b,
k,d,g,h,r,v,y,p){var m=f.Utils.Curve.CollinearityEpsilon,D=f.Utils.Curve.RecursionLimit,z=f.Utils.Curve.CuspLimit,s=f.Utils.Curve.Tolerance,q;p=p||0;if(p>D)return[];var D=(b+d)/2,x=(k+g)/2,I=(d+h)/2,l=(g+r)/2,Q=(h+v)/2,R=(r+y)/2,S=(D+I)/2,T=(x+l)/2,I=(I+Q)/2,l=(l+R)/2,E=(S+I)/2,F=(T+l)/2;q=v-b;var B=y-k,J=c((d-v)*B-(g-y)*q),K=c((h-v)*B-(r-y)*q);if(0<p){if(J>m&&K>m&&(J+K)*(J+K)<=s.distance*(q*q+B*B)){if(s.angle<s.epsilon)return[new f.Vector(E,F)];q=e(r-g,h-d);m=c(q-e(g-k,d-b));q=c(e(y-r,v-h)-q);m>=
n&&(m=a-m);q>=n&&(q=a-q);if(m+q<s.angle)return[new f.Vector(E,F)];if(0!==z){if(m>z)return[new f.Vector(d,g)];if(q>z)return[new f.Vector(h,r)]}}}else if(J>m)if(J*J<=s.distance*(q*q+B*B)){if(s.angle<s.epsilon)return[new f.Vector(E,F)];m=c(e(r-g,h-d)-e(g-k,d-b));m>=n&&(m=a-m);if(m<s.angle)return[new f.Vector(d,g),new f.Vector(h,r)];if(0!==z&&m>z)return[new f.Vector(d,g)]}else if(K>m){if(K*K<=s.distance*(q*q+B*B)){if(s.angle<s.epsilon)return[new f.Vector(E,F)];m=c(e(y-r,v-h)-e(r-g,h-d));m>=n&&(m=a-m);
if(m<s.angle)return[new f.Vector(d,g),new f.Vector(h,r)];if(0!==z&&m>z)return[new f.Vector2(h,r)]}}else if(q=E-(b+v)/2,B=F-(k+y)/2,q*q+B*B<=s.distance)return[new f.Vector(E,F)];return f.Utils.subdivide(b,k,D,x,S,T,E,F,p+1).concat(f.Utils.subdivide(E,F,I,l,Q,R,v,y,p+1))},getCurveFromPoints:function(a,b){for(var d=[],c=a.length,f=c-1,k=0;k<c;k++){var e=a[k],g={x:e.x,y:e.y};d.push(g);var e=b?x(k-1,c):Math.max(k-1,0),n=b?x(k+1,c):Math.min(k+1,f);s(a[e],g,a[n]);g.u.x||g.u.y||(g.u.x=g.x,g.u.y=g.y);g.v.x||
g.v.y||(g.v.x=g.x,g.v.y=g.y)}return d},getControlPoints:function(a,b,d){var c=z(a,b),f=z(d,b);a=y(a,b);d=y(d,b);var e=(c+f)/2;if(1E-4>a||1E-4>d)return b.u={x:b.x,y:b.y},b.v={x:b.x,y:b.y},b;a*=0.33;d*=0.33;e=f<c?e+k:e-k;c={x:b.x+g(e)*a,y:b.y+m(e)*a};e-=n;f={x:b.x+g(e)*d,y:b.y+m(e)*d};b.u=c;b.v=f;return b},angleBetween:function(a,b){return e(a.y-b.y,a.x-b.x)},distanceBetweenSquared:function(a,b){var d=a.x-b.x,c=a.y-b.y;return d*d+c*c},distanceBetween:function(a,c){return b(D(a,c))},mod:function(a,b){for(;0>
a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});f.Utils.Error.prototype=Error();f.Utils.Error.prototype.constructor=f.Utils.Error;var y=f.Utils.distanceBetween,D=f.Utils.distanceBetweenSquared,z=f.Utils.angleBetween,s=f.Utils.getControlPoints,x=f.Utils.mod;_.extend(f.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){f.Utils.setPlaying.call(this,!0);return this.trigger(f.Events.play)},pause:function(){this.playing=
!1;return this.trigger(f.Events.pause)},update:function(){_.defer(_.bind(function(){var a=!!this._lastFrame,b=(window.performance&&window.performance.now?window.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,d=this.renderer;a===d.width&&b===d.height||d.setSize(a,b);this.trigger(f.Events.update,this.frameCount,this.timeDelta);this.render()},this));return this},render:function(){this.renderer.render();
return this.trigger(f.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,d,c){d=(d-a)/2;c=(c-b)/2;var k=[new f.Vector(-d,-c),new f.Vector(d,c)],k=(new f.Polygon(k)).noFill();k.translation.set(a+d,b+c);this.scene.add(k);return k},
makeRectangle:function(a,b,d,c){d/=2;c/=2;c=[new f.Vector(d,c),new f.Vector(-d,c),new f.Vector(-d,-c),new f.Vector(d,-c)];c=new f.Polygon(c,!0);c.translation.set(a,b);this.scene.add(c);return c},makeCircle:function(a,b,d){return this.makeEllipse(a,b,d,d)},makeEllipse:function(b,c,d,k){var e=f.Resolution,n=_.map(_.range(e),function(b){var c=b/e*a;b=d*g(c);c=k*m(c);return new f.Vector(b,c)},this),n=new f.Polygon(n,!0,!0);n.translation.set(b,c);this.scene.add(n);return n},makeCurve:function(a){var b=
arguments.length,d=a;if(!_.isArray(a))for(var d=[],c=0;c<b;c+=2){var k=arguments[c];if(!_.isNumber(k))break;d.push(new f.Vector(k,arguments[c+1]))}var b=arguments[b-1],d=new f.Polygon(d,!(_.isBoolean(b)&&b),!0),b=d.getBoundingClientRect(),e=b.left+b.width/2,g=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=e;a.y-=g});d.translation.set(e,g);this.scene.add(d);return d},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],k=0;k<b;k+=2){var e=arguments[k];if(!_.isNumber(e))break;
c.push(new f.Vector(e,arguments[k+1]))}b=arguments[b-1];c=new f.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new f.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in f.Utils.read))return null;a=f.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(f.Instances,
function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})();"function"===typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof module&&module.exports&&(module.exports=f)})();(function(){var q=Two.Vector=function(h,p){h=h||0;p=p||0;Object.defineProperty(this,"x",{get:function(){return h},set:function(m){h=m;this.trigger(Two.Events.change,"x")}});Object.defineProperty(this,"y",{get:function(){return p},set:function(h){p=h;this.trigger(Two.Events.change,"y")}})};_.extend(q,{});_.extend(q.prototype,Backbone.Events,{set:function(h,p){this.x=h;this.y=p;return this},copy:function(h){this.x=h.x;this.y=h.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new q(this.x,
this.y)},add:function(h,p){this.x=h.x+p.x;this.y=h.y+p.y;return this},addSelf:function(h){this.x+=h.x;this.y+=h.y;return this},sub:function(h,p){this.x=h.x-p.x;this.y=h.y-p.y;return this},subSelf:function(h){this.x-=h.x;this.y-=h.y;return this},multiplySelf:function(h){this.x*=h.x;this.y*=h.y;return this},multiplyScalar:function(h){this.x*=h;this.y*=h;return this},divideScalar:function(h){h?(this.x/=h,this.y/=h):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(h){return this.x*
h.x+this.y*h.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(h){return Math.sqrt(this.distanceToSquared(h))},distanceToSquared:function(h){var p=this.x-h.x;h=this.y-h.y;return p*p+h*h},setLength:function(h){return this.normalize().multiplyScalar(h)},equals:function(h){return 1E-4>this.distanceTo(h)},lerp:function(h,p){return this.set((h.x-this.x)*
p+this.x,(h.y-this.y)*p+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var q=Math.cos,h=Math.sin,p=Math.tan,m=Two.Matrix=function(g,e,b,c,n,a){this.elements=new Two.Array(9);var k=g;_.isArray(k)||(k=_.toArray(arguments));this.identity().set(k)};_.extend(m,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(g,e){if(3>=e.length){var b=e[0]||0,c=e[1]||0,n=e[2]||0;return{x:g[0]*b+g[1]*c+g[2]*n,y:g[3]*b+g[4]*c+g[5]*n,z:g[6]*b+g[7]*c+g[8]*n}}var b=g[0],c=g[1],n=g[2],a=g[3],k=g[4],h=g[5],r=g[6],f=g[7],m=g[8],p=e[0],q=e[1],s=e[2],x=e[3],t=e[4],u=e[5],d=e[6],
w=e[7],A=e[8];return[b*p+c*x+n*d,b*q+c*t+n*w,b*s+c*u+n*A,a*p+k*x+h*d,a*q+k*t+h*w,a*s+k*u+h*A,r*p+f*x+m*d,r*q+f*t+m*w,r*s+f*u+m*A]}});_.extend(m.prototype,Backbone.Events,{set:function(g,e,b,c,n,a){var k=g;_.isArray(k)||(k=_.toArray(arguments));_.each(k,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(m.Identity);return this},multiply:function(g,e,b,c,n,a,k,h,r){var f=arguments,m=f.length;if(1>=m)return _.each(this.elements,
function(a,b){this.elements[b]=a*g},this),this.trigger(Two.Events.change);if(3>=m)return g=g||0,e=e||0,b=b||0,n=this.elements,{x:n[0]*g+n[1]*e+n[2]*b,y:n[3]*g+n[4]*e+n[5]*b,z:n[6]*g+n[7]*e+n[8]*b};m=this.elements;A0=m[0];A1=m[1];A2=m[2];A3=m[3];A4=m[4];A5=m[5];A6=m[6];A7=m[7];A8=m[8];B0=f[0];B1=f[1];B2=f[2];B3=f[3];B4=f[4];B5=f[5];B6=f[6];B7=f[7];B8=f[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},inverse:function(g){var e=this.elements;g=g||new Two.Matrix;var b=e[0],c=e[1],n=e[2],a=e[3],k=e[4],h=e[5],r=e[6],f=e[7],e=e[8],m=e*k-h*f,p=-e*a+h*r,q=f*a-k*r,s=b*m+c*p+n*q;if(!s)return null;s=1/s;g.elements[0]=m*s;g.elements[1]=(-e*c+n*f)*s;g.elements[2]=(h*c-n*k)*s;g.elements[3]=p*s;g.elements[4]=(e*b-
n*r)*s;g.elements[5]=(-h*b+n*a)*s;g.elements[6]=q*s;g.elements[7]=(-f*b+c*r)*s;g.elements[8]=(k*b-c*a)*s;return g},scale:function(g,e){1>=arguments.length&&(e=g);return this.multiply(g,0,0,0,e,0,0,0,1)},rotate:function(g){var e=q(g);g=h(g);return this.multiply(e,-g,0,g,e,0,0,0,1)},translate:function(g,e){return this.multiply(1,0,g,0,1,e,0,0,1)},skewX:function(g){g=p(g);return this.multiply(1,g,0,0,1,0,0,0,1)},skewY:function(g){g=p(g);return this.multiply(1,0,0,g,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},
toArray:function(g){var e=this.elements,b=parseFloat(e[0].toFixed(3)),c=parseFloat(e[1].toFixed(3)),h=parseFloat(e[2].toFixed(3)),a=parseFloat(e[3].toFixed(3)),k=parseFloat(e[4].toFixed(3)),v=parseFloat(e[5].toFixed(3));if(g){g=parseFloat(e[6].toFixed(3));var r=parseFloat(e[7].toFixed(3)),e=parseFloat(e[8].toFixed(3));return[b,a,g,c,k,r,h,v,e]}return[b,a,c,k,h,v]},clone:function(){return new Two.Matrix(this.elements[0],this.elements[1],this.elements[2],this.elements[3],this.elements[4],this.elements[5],
this.elements[6],this.elements[7],this.elements[8])}})})();(function(){function q(b){var c={},h=b.id,a=b.translation,k=b.rotation,v=b.scale,r=b.stroke,f=b.linewidth,m=b.fill,p=b.opacity,q=b.visible,s=b.cap,x=b.join,t=b.miter,u=b.curved,d=b.closed,w=b.vertices;h&&(c.id=e.Identifier+h);a&&(_.isNumber(v)&&_.isNumber(k))&&(c.transform="matrix("+b._matrix.toString()+")");r&&(c.stroke=r);m&&(c.fill=m);p&&(c["stroke-opacity"]=c["fill-opacity"]=p);c.visibility=q?"visible":"hidden";s&&(c["stroke-linecap"]=s);x&&(c["stroke-linejoin"]=x);t&&(c["stroke-miterlimit"]=
t);f&&(c["stroke-width"]=f);w&&(c.d=g.toString(w,d,u));return c}function h(b,c,e,a,k){switch(c){case "matrix":c="transform";e="matrix("+e.toString()+")";break;case "visible":c="visibility";e=e?"visible":"hidden";break;case "cap":c="stroke-linecap";break;case "join":c="stroke-linejoin";break;case "miter":c="stroke-miterlimit";break;case "linewidth":c="stroke-width";break;case "vertices":c="d";e=g.toString(e,a,k);break;case "opacity":g.setAttributes(b,{"stroke-opacity":e,"fill-opacity":e});return}b.setAttribute(c,
e)}var p=Two.Utils.getCurveFromPoints,m=Two.Utils.mod,g={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,c){var e=document.createElementNS(this.ns,b);"svg"===b&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&this.setAttributes(e,c);return e},setAttributes:function(b,c){_.each(c,function(b,a){this.setAttribute(a,b)},b);return this},removeAttributes:function(b,c){_.each(c,function(b){this.removeAttribute(b)},b);return this},toString:function(b,
c,e){var a=b.length,k=a-1;if(!e)return _.map(b,function(a,b){var e;e=(0>=b?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));b>=k&&c&&(e+=" Z");return e}).join(" ");var g=p(b,c);return _.map(g,function(b,f){var e,h=c?m(f-1,a):Math.max(f-1,0),n=c?m(f+1,a):Math.min(f+1,k);e=g[h];var n=g[n],h=e.v.x.toFixed(3),p=e.v.y.toFixed(3),q=b.u.x.toFixed(3),t=b.u.y.toFixed(3),u=b.x.toFixed(3),d=b.y.toFixed(3);e=0>=f?"M "+u+" "+d:"C "+h+" "+p+" "+q+" "+t+" "+u+" "+d;f>=k&&c&&(h=b.v.x.toFixed(3),p=b.v.y.toFixed(3),
q=n.u.x.toFixed(3),t=n.u.y.toFixed(3),u=n.x.toFixed(3),d=n.y.toFixed(3),e=e+(" C "+h+" "+p+" "+q+" "+t+" "+u+" "+d)+" Z");return e}).join(" ")}},e=Two[Two.Types.svg]=function(){this.count=0;this.domElement=g.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(e,{Identifier:"two-",Utils:g});_.extend(e.prototype,Backbone.Events,{setSize:function(b,c){this.width=b;this.height=
c;g.setAttributes(this.domElement,{width:b,height:c});return this},add:function(b){var c=b,e=this.elements,a=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;if(_.isUndefined(b.id)){var h=this.count;this.count++;b.id=h}c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=q(b),delete b.stroke,delete b.fill,delete b["fill-opacity"],delete b["stroke-opacity"],
delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=q(b));b=g.createElement(c,b);a.appendChild(b);e.push(b)},this);return this},update:function(b,c,e,a,k){var g=this.elements,r=g[b];switch(c){case Two.Properties.hierarchy:_.each(e,function(a){r.appendChild(g[a])});break;case Two.Properties.demotion:_.each(e,function(a){r.removeChild(g[a])});break;default:h(r,c,e,a,k)}return this},render:function(){this.unveil();return this}})})();(function(){var q=Two.Utils.getCurveFromPoints,h=Two.Utils.mod,p=function(b){_.each(b,function(b,e){this[e]=b},this);this.children=[]};_.extend(p.prototype,{appendChild:function(b){var c=b.parent;_.isUndefined(c)||c.removeChild(b);this.children.push(b);b.parent=this;return this},removeChild:function(b){b=_.indexOf(this.children,b);return 0>b?this:this.children.splice(b,1)[0]},render:function(b){var c=this.matrix;b.save();b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);_.each(this.children,function(c){c.render(b)});
b.restore();return this}});var m=function(b){_.each(b,function(b,e){this[e]=b},this)};_.extend(m.prototype,{render:function(b){var c=this.matrix,e=this.stroke,a=this.linewidth,k=this.fill,g=this.opacity,r=this.cap,f=this.join,m=this.miter,p=this.curved,q=this.closed,s=this.commands,x=s.length,t=x-1;if(!this.visible)return this;b.save();c&&b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);k&&(b.fillStyle=k);e&&(b.strokeStyle=e);a&&(b.lineWidth=a);m&&(b.miterLimit=m);f&&(b.lineJoin=f);r&&(b.lineCap=r);_.isNumber(g)&&
(b.globalAlpha=g);b.beginPath();_.each(s,function(a,c){var f=a.x.toFixed(3),e=a.y.toFixed(3);if(p){var k=q?h(c-1,x):Math.max(c-1,0),g=q?h(c+1,x):Math.min(c+1,t),n=s[k],g=s[g],k=n.v.x.toFixed(3),n=n.v.y.toFixed(3),r=a.u.x.toFixed(3),m=a.u.y.toFixed(3);0>=c?b.moveTo(f,e):(b.bezierCurveTo(k,n,r,m,f,e),c>=t&&q&&(k=a.v.x.toFixed(3),n=a.v.y.toFixed(3),r=g.u.x.toFixed(3),m=g.u.y.toFixed(3),f=g.x.toFixed(3),e=g.y.toFixed(3),b.bezierCurveTo(k,n,r,m,f,e)))}else 0>=c?b.moveTo(f,e):b.lineTo(f,e)});q&&!p&&b.closePath();
b.fill();b.stroke();b.restore()}});var g={devicePixelRatio:this.devicePixelRatio||1,getBackingStoreRatio:function(b){return b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1},getRatio:function(b){return this.devicePixelRatio/this.getBackingStoreRatio(b)},toArray:function(b,c,e){return c?q(b,e):_.map(b,function(a,b){return{x:a.x,y:a.y}})}},e=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");
this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.elements=[];this.stage=null};_.extend(e,{Group:p,Element:m,getStyles:function(b){var c={},e=b.id,a=b._matrix,k=b.stroke,h=b.linewidth,r=b.fill,f=b.opacity,m=b.visible,p=b.cap,q=b.join,s=b.miter,x=b.curved,t=b.closed;b=b.vertices;e&&(c.id=e);_.isObject(a)&&(c.matrix=a.toArray());k&&(c.stroke=k);r&&(c.fill=r);_.isNumber(f)&&(c.opacity=f);p&&(c.cap=p);q&&(c.join=q);s&&(c.miter=s);h&&(c.linewidth=h);b&&(c.commands=g.toArray(b,x,t));c.visible=
!!m;c.curved=!!x;c.closed=!!t;return c},setStyles:function(b,c,e,a,k){switch(c){case "matrix":c="matrix";e=e.toArray();break;case "vertices":c="commands",b.curved=k,b.closed=a,e=g.toArray(e,b.curved,b.closed)}b[c]=e},Utils:g});_.extend(e.prototype,Backbone.Events,{setSize:function(b,c,e){this.width=b;this.height=c;this.ratio=_.isUndefined(e)?g.getRatio(this.ctx):e;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,{width:b+"px",height:c+"px"});return this},
add:function(b){constructor=Object.getPrototypeOf(this).constructor;var c=b,e=this.elements,a=constructor.Group,k=constructor.Element,g=constructor.getStyles;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;var h=_.isNull(this.stage);if(_.isUndefined(b.id)){var m=this.count;this.count++;b.id=m}c?(c=g.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,delete c.linewidth,c=new a(c),h&&(this.stage=
c,this.stage.object=b,b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new k(g.call(this,b));e.push(c);h||this.stage.appendChild(c)},this);return this},update:function(b,c,e,a,k,g){var h=Object.getPrototypeOf(this).constructor,f=this.elements,m=f[b];switch(c){case Two.Properties.hierarchy:_.each(e,function(a){m.appendChild(f[a])});break;case Two.Properties.demotion:_.each(e,function(a){m.removeChild(f[a]);this.elements[a]=null},this);break;default:h.setStyles.call(this,
m,c,e,a,k,g)}return this},render:function(){if(_.isNull(this.stage))return this;1!==this.ratio&&(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);1!==this.ratio&&this.ctx.restore();return this}})})();(function(){function q(a,b){var c=Math.min(a.top,b.top),e=Math.min(a.left,b.left),f=Math.max(a.right,b.right),g=Math.max(a.bottom,b.bottom);return{top:c,left:e,right:f,bottom:g,width:f-e,height:g-c,centroid:{x:-e,y:-c}}}var h=Two[Two.Types.canvas],p=Two.Matrix.Multiply,m=Two[Two.Types.canvas].Utils.toArray,g=Two.Utils.mod,e=function(a){h.Group.call(this,a)};_.extend(e.prototype,h.Group.prototype,{appendChild:function(){h.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},
updateTexture:function(a){_.each(this.children,function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=p(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var b=function(a){h.Element.call(this,a)};_.extend(b.prototype,
h.Element.prototype,{updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=p(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){c.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,
this.texture);a.uniformMatrix3fv(b.matrix,!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var c={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b,c){var e=Infinity,f=-Infinity,g=Infinity,h=-Infinity;_.each(a,function(a,b){var k=a.x,n=a.y,m,d;g=Math.min(n,g);e=Math.min(k,e);f=Math.max(k,f);h=Math.max(n,h);c&&(k=a.u.x,n=a.u.y,
m=a.v.x,d=a.v.y,g=Math.min(n,d,g),e=Math.min(k,m,e),f=Math.max(k,m,f),h=Math.max(n,d,h))});_.isNumber(b)&&(g-=b,e-=b,f+=b,h+=b);return{top:g,left:e,right:f,bottom:h,width:f-e,height:h-g,centroid:{x:-e,y:-g}}},getTriangles:function(a){var b=a.top,c=a.left,e=a.right;a=a.bottom;return new Two.Array([c,b,e,b,c,a,c,a,e,b,e,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,e=this.ctx,f=a._scale,h=a.stroke,n=a.linewidth*f,m=a.fill,p=a.opacity,q=a.cap,t=a.join,u=a.miter,d=a.curved,w=a.closed,A=
b.length,L=A-1;c.width=Math.max(Math.ceil(a.rect.width*f),1);c.height=Math.max(Math.ceil(a.rect.height*f),1);a=a.rect.centroid;var G=a.x*f,C=a.y*f;e.clearRect(0,0,c.width,c.height);m&&(e.fillStyle=m);h&&(e.strokeStyle=h);n&&(e.lineWidth=n);u&&(e.miterLimit=u);t&&(e.lineJoin=t);q&&(e.lineCap=q);_.isNumber(p)&&(e.globalAlpha=p);e.beginPath();_.each(b,function(a,c){var h=(a.x*f+G).toFixed(3),n=(a.y*f+C).toFixed(3);if(d){var m=w?g(c-1,A):Math.max(c-1,0),p=w?g(c+1,A):Math.min(c+1,L),q=b[m],p=b[p],m=(q.v.x*
f+G).toFixed(3),q=(q.v.y*f+C).toFixed(3),v=(a.u.x*f+G).toFixed(3),l=(a.u.y*f+C).toFixed(3);0>=c?e.moveTo(h,n):(e.bezierCurveTo(m,q,v,l,h,n),c>=L&&w&&(m=(a.v.x*f+G).toFixed(3),q=(a.v.y*f+C).toFixed(3),v=(p.u.x*f+G).toFixed(3),l=(p.u.y*f+C).toFixed(3),h=(p.x*f+G).toFixed(3),n=(p.y*f+C).toFixed(3),e.bezierCurveTo(m,q,v,l,h,n)))}else 0>=c?e.moveTo(h,n):e.lineTo(h,n)});w&&!d&&e.closePath();e.fill();e.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,
b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,
b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,
a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};c.ctx=c.canvas.getContext("2d");var n=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",
a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=c.shaders.create(a,c.shaders.vertex,c.shaders.types.vertex),e=c.shaders.create(a,c.shaders.fragment,c.shaders.types.fragment);this.program=c.program.create(a,[b,e]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=a.getAttribLocation(this.program,"a_textureCoords");
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(n,{Group:e,Element:b,getStyles:function(a){var e={},g=a.id,h=a._matrix,f=a.stroke,n=a.linewidth,p=a.fill,q=a.opacity,s=a.visible,x=a.cap,t=a.join,u=a.miter,d=a.curved,w=a.closed,A=a.vertices;g&&(e.id=g);_.isObject(h)&&(e.matrix=e._matrix=h.toArray(!0),e.scale=e._scale=1);f&&(e.stroke=f);p&&(e.fill=p);_.isNumber(q)&&(e.opacity=
q);x&&(e.cap=x);t&&(e.join=t);u&&(e.miter=u);n&&(e.linewidth=n);A&&(e.vertices=m(A,d,w),e.commands=e.vertices,e.rect=c.getBoundingClientRect(e.commands,e.linewidth,e.curved),e.triangles=c.getTriangles(e.rect));e.visible=!!s;e.curved=!!d;e.closed=!!w;a instanceof Two.Polygon&&(c.updateBuffer(this.ctx,e,this.program),b.prototype.updateTexture.call(e,this.ctx));return e},setStyles:function(a,b,e,g,f,h){var n=!1;/matrix/.test(b)?(a[b]=e.toArray(!0),_.isNumber(g)&&(n=a.scale!==g,a.scale=g),a.updateMatrix()):
/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=e,a.rect=q(c.getBoundingClientRect(a.commands,a.linewidth,a.curved),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),n=!0):"vertices"===b?(_.isUndefined(g)||(a.closed=g),_.isUndefined(f)||(a.curved=f),h?a.commands=m(e,a.curved,a.closed):(a.vertices=m(e,a.curved,a.closed),a.commands=a.vertices),a.rect=q(c.getBoundingClientRect(a.vertices,a.linewidth,a.curved),a.rect),a.triangles=c.getTriangles(a.rect),
c.updateBuffer(this.ctx,a,this.program),n=!0):a[b]=e;n&&a.updateTexture(this.ctx)}});_.extend(n.prototype,Backbone.Events,h.prototype,{setSize:function(a,b){h.prototype.setSize.apply(this,arguments);this.ratio=1;this.domElement.width=a;this.domElement.height=b;this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var q=Two.Shape=function(h){this._matrix=new Two.Matrix;var p=_.debounce(_.bind(function(){var h=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",h,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(h){this._rotation=h;p()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(h){this._scale=h;p()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,p);if(h)return this;q.MakeGetterSetter(this,q.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=1};_.extend(q,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(h,p){_.isArray(p)||(p=[p]);_.each(p,function(m){var g="_"+m;Object.defineProperty(h,
m,{get:function(){return this[g]},set:function(e){this[g]=e;this.trigger(Two.Events.change,this.id,m,e,this)}})})}});_.extend(q.prototype,Backbone.Events,{addTo:function(h){h.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var h=new q;h.translation.copy(this.translation);_.each(q.Properties,function(p){h[p]=this[p]},this);return this}})})();(function(){var q=Two.Group=function(h){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;q.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(q,{MakeGetterSetter:function(h,p){_.isArray(p)||(p=[p]);_.each(p,function(m){var g="_"+m;Object.defineProperty(h,m,{get:function(){return this[g]},set:function(e){this[g]=e;_.each(this.children,function(b){b[m]=e})}})})}});_.extend(q.prototype,
Two.Shape.prototype,{clone:function(h){h=h||this.parent;var p=_.map(this.children,function(g){return g.clone(h)}),m=new q;h.add(m);m.add(p);m.translation.copy(this.translation);m.rotation=this.rotation;m.scale=this.scale;return m},corner:function(){var h=this.getBoundingClientRect(!0),p={x:h.left,y:h.top};_.each(this.children,function(h){h.translation.subSelf(p)});return this},center:function(){var h=this.getBoundingClientRect(!0);h.centroid={x:h.left+h.width/2,y:h.top+h.height/2};_.each(this.children,
function(p){p.translation.subSelf(h.centroid)});return this},add:function(h){var p=h,m=this.children,g=this.parent,e=[];_.isArray(h)||(p=_.toArray(arguments));var b=_.bind(function(b,e,a,g,h,m){this.trigger(Two.Events.change,b,e,a,g,h,m)},this);_.each(p,function(c){if(c){var h=c.id,a=c.parent;_.isUndefined(h)&&(g.add(c),h=c.id);_.isUndefined(m[h])&&(a&&delete a.children[h],m[h]=c,c.parent=this,c.unbind(Two.Events.change).bind(Two.Events.change,b),e.push(h))}},this);0<e.length&&this.trigger(Two.Events.change,
this.id,Two.Properties.hierarchy,e);return this},remove:function(h){var p=h,m=this.children,g=this.parent,e=[];if(0>=arguments.length&&g)return g.remove(this),this;_.isArray(h)||(p=_.toArray(arguments));_.each(p,function(b){var c=b.id;c in m&&(delete m[c],delete b.parent,b.unbind(Two.Events.change),e.push(c))});0<e.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,e);return this},getBoundingClientRect:function(h){var p=Infinity,m=-Infinity,g=Infinity,e=-Infinity;_.each(this.children,
function(b){b=b.getBoundingClientRect(!0);g&&(p&&m&&e)&&(g=Math.min(b.top,g),p=Math.min(b.left,p),m=Math.max(b.right,m),e=Math.max(b.bottom,e))},this);var b=h?this._matrix:Two.Utils.getComputedMatrix(this);h=b.multiply(p,g,1);b=b.multiply(m,e,1);return{top:h.y,left:h.x,right:b.x,bottom:b.y,width:b.x-h.x,height:b.y-h.y}},noFill:function(){_.each(this.children,function(h){h.noFill()});return this},noStroke:function(){_.each(this.children,function(h){h.noStroke()});return this}})})();(function(){var q=Math.min,h=Math.max,p=Math.round,m=Two.Polygon=function(g,e,b){Two.Shape.call(this);e=!!e;b=!!b;var c=0,n=1,a=!1,k=g.slice(0),m=_.debounce(_.bind(function(g){var f;if(a)for(g=this.vertices.length,g-=1,f=p(c*g),g=p(n*g),k.length=0;f<g+1;f++){var h=this.vertices[f];k.push(new Two.Vector(h.x,h.y))}this.trigger(Two.Events.change,this.id,"vertices",k,e,b,a);a=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return e},set:function(a){e=!!a;m()}});Object.defineProperty(this,
"curved",{get:function(){return b},set:function(a){b=!!a;m()}});Object.defineProperty(this,"beginning",{get:function(){return c},set:function(b){c=q(h(b,0),1);a=!0;m()}});Object.defineProperty(this,"ending",{get:function(){return n},set:function(b){n=q(h(b,0),1);a=!0;m()}});this.vertices=g.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,m)},this);m()};_.extend(m.prototype,Two.Shape.prototype,{clone:function(){var g=_.map(this.vertices,function(b){return new Two.Vector(b.x,b.y)}),
e=new m(g,this.closed,this.curved);_.each(Two.Shape.Properties,function(b){e[b]=this[b]},this);e.translation.copy(this.translation);e.rotation=this.rotation;e.scale=this.scale;return e},corner:function(){var g=this.getBoundingClientRect(!0),e={x:g.left,y:g.top};_.each(this.vertices,function(b){b.subSelf(e)});return this},center:function(){var g=this.getBoundingClientRect(!0);g.centroid={x:g.left+g.width/2,y:g.top+g.height/2};_.each(this.vertices,function(e){e.subSelf(g.centroid)});return this},remove:function(){if(!this.parent)return this;
this.parent.remove(this);return this},getBoundingClientRect:function(g){var e=this.linewidth,b=Infinity,c=-Infinity,h=Infinity,a=-Infinity;_.each(this.vertices,function(e){var g=e.x;e=e.y;h=Math.min(e,h);b=Math.min(g,b);c=Math.max(g,c);a=Math.max(e,a)});h-=e;b-=e;c+=e;a+=e;e=g?this._matrix:Two.Utils.getComputedMatrix(this);g=e.multiply(b,h,1);e=e.multiply(c,a,1);return{top:g.y,left:g.x,right:e.x,bottom:e.y,width:e.x-g.x,height:e.y-g.y}}})})();
